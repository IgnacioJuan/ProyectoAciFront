"use strict";(self.webpackChunksistema_security=self.webpackChunksistema_security||[]).push([[443],{6302:(E,b,s)=>{s.d(b,{v:()=>u});var l=s(8896);class u{constructor(){this.id_evidencia=0,this.enlace="",this.nombre="",this.descripcion="",this.visible="",this.estado="",this.indicador=new l.s}}},8896:(E,b,s)=>{s.d(b,{s:()=>l});class l{constructor(){this.id_indicador=0,this.nombre="",this.descripcion="",this.peso=0,this.tipo="",this.estandar=0,this.valor_obtenido=0,this.porc_obtenido=0,this.porc_utilida_obtenida=0,this.subcriterio=null,this.visible=!0}}},2271:(E,b,s)=>{s.d(b,{p:()=>l});class l{constructor(){this.id_subcriterio=0,this.nombre="",this.descripcion="",this.criterio=null,this.visible=!0}}},2802:(E,b,s)=>{s.d(b,{D:()=>l});class l{constructor(){this.evidencia=null,this.usuario=null}}},4443:(E,b,s)=>{s.r(b),s.d(b,{ResponsableModule:()=>me});var l=s(6895),u=s(1635),v=s(6302);class A{constructor(){this.id_archivo=0,this.enlace="",this.nombre="",this.descripcion="",this.actividad=null,this.visible=""}}var g=s(2802),p=s(4006),n=s(5226),c=s.n(n),_=s(285),d=s(3626),x=s(8739),Y=s(3900),K=s(9646),t=s(4650),W=s(3224),j=s(2185),V=s(2130),S=s(4120),P=s(2068),B=s(1818),$=s(9518);const X=["datosModalRef"];function tt(e,r){1&e&&(t.TgZ(0,"button",50),t._uU(1," CREAR NUEVA ACTIVIDAD "),t.qZA())}function it(e,r){if(1&e&&(t.TgZ(0,"th",51),t._uU(1,"ID"),t.qZA()),2&e){const i=t.oxw();t.Udp("display",i.ocultar?"":"none")}}function et(e,r){if(1&e&&(t.TgZ(0,"td",52),t._uU(1),t.qZA()),2&e){const i=r.$implicit,a=t.oxw();t.Udp("display",a.ocultar?"":"none"),t.xp6(1),t.Oqu(i.id_actividad)}}function at(e,r){1&e&&(t.TgZ(0,"th",51),t._uU(1,"NOMBRE"),t.qZA())}function ot(e,r){if(1&e&&(t.TgZ(0,"td",52),t._uU(1),t.qZA()),2&e){const i=r.$implicit;t.xp6(1),t.Oqu(i.nombre)}}function rt(e,r){1&e&&(t.TgZ(0,"th",51),t._uU(1,"DESCRIPCI\xd3N"),t.qZA())}function nt(e,r){if(1&e&&(t.TgZ(0,"td",52),t._uU(1),t.qZA()),2&e){const i=r.$implicit;t.xp6(1),t.Oqu(i.descripcion)}}function st(e,r){1&e&&(t.TgZ(0,"th",51),t._uU(1,"FECHA DE INICIO"),t.qZA())}function ct(e,r){if(1&e&&(t.TgZ(0,"td",52),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const i=r.$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,i.fecha_inicio,"dd/MM/yyyy"))}}function dt(e,r){1&e&&(t.TgZ(0,"th",51),t._uU(1,"FECHA FINALIZACION"),t.qZA())}function lt(e,r){if(1&e&&(t.TgZ(0,"td",52),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const i=r.$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,i.fecha_fin,"dd/MM/yyyy"))}}function ut(e,r){1&e&&(t.TgZ(0,"th",51),t._uU(1,"ESTADO"),t.qZA())}function ht(e,r){if(1&e&&(t.TgZ(0,"td",53),t._uU(1),t.qZA()),2&e){const i=r.$implicit,a=t.oxw();t.Q6J("ngClass",a.getColorEstado(i.estado)),t.xp6(1),t.Oqu(i.estado.toUpperCase())}}function pt(e,r){1&e&&(t.TgZ(0,"th",51),t._uU(1,"Observaci\xf3n"),t.qZA())}function _t(e,r){if(1&e&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&e){const i=r.$implicit;t.xp6(1),t.hij(" ",i," ")}}function mt(e,r){if(1&e&&(t.TgZ(0,"td",52),t.YNc(1,_t,2,1,"div",54),t.qZA()),2&e){const i=r.$implicit;t.xp6(1),t.Q6J("ngForOf",i.observacion)}}function vt(e,r){1&e&&(t.TgZ(0,"th",51),t._uU(1,"Subir evidencia"),t.qZA())}function gt(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"td",52)(1,"button",55),t.NdJ("click",function(){const h=t.CHM(i).$implicit,m=t.oxw();return t.KtG(m.verDetalles(h))}),t.TgZ(2,"div",56),t._UZ(3,"span",57)(4,"i",58),t.qZA()()()}}function ft(e,r){1&e&&(t.TgZ(0,"th",51),t._uU(1,"ACCI\xd3N"),t.qZA())}function bt(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"button",62),t.NdJ("click",function(){t.CHM(i);const o=t.oxw().$implicit,h=t.oxw();return t.KtG(h.editDatos(o))}),t._UZ(1,"i",63),t.qZA()}}function Ct(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"button",64),t.NdJ("click",function(){t.CHM(i);const o=t.oxw().$implicit,h=t.oxw();return t.KtG(h.eliminar(o))}),t._UZ(1,"i",65),t.qZA()}}function At(e,r){if(1&e&&(t.TgZ(0,"td",52)(1,"div",59),t.YNc(2,bt,2,0,"button",60),t.YNc(3,Ct,2,0,"button",61),t.qZA()()),2&e){const i=r.$implicit;t.xp6(2),t.Q6J("ngIf","Aprobada"!==i.estado),t.xp6(1),t.Q6J("ngIf","Aprobada"!==i.estado)}}function xt(e,r){1&e&&t._UZ(0,"tr",66)}function Zt(e,r){1&e&&t._UZ(0,"tr",67)}function Tt(e,r){1&e&&(t.TgZ(0,"div"),t._uU(1," Debe ingresar un nombre "),t.qZA())}function Dt(e,r){if(1&e&&(t.TgZ(0,"div",68),t.YNc(1,Tt,2,0,"div",69),t.qZA()),2&e){const i=t.oxw();t.xp6(1),t.Q6J("ngIf",i.frmActividades.controls.nombre.hasError("required"))}}function It(e,r){1&e&&(t.TgZ(0,"div"),t._uU(1," La descripci\xf3n no puede estar vac\xeda "),t.qZA())}function Et(e,r){1&e&&(t.TgZ(0,"div"),t._uU(1," Excedi\xf3 el n\xfamero de caracteres permitidos "),t.qZA())}function yt(e,r){if(1&e&&(t.TgZ(0,"div",68),t.YNc(1,It,2,0,"div",69),t.YNc(2,Et,2,0,"div",69),t.qZA()),2&e){const i=t.oxw();t.xp6(1),t.Q6J("ngIf",i.frmActividades.controls.descripcion.hasError("required")),t.xp6(1),t.Q6J("ngIf",i.frmActividades.controls.descripcion.hasError("maxlength"))}}function Ut(e,r){1&e&&(t.TgZ(0,"div",68),t._uU(1," La fecha de finalizaci\xf3n debe ser posterior a la fecha de inicio. "),t.qZA())}function Mt(e,r){if(1&e&&(t.TgZ(0,"button",70),t._uU(1," Agregar "),t.qZA()),2&e){const i=t.oxw();t.Q6J("disabled",!i.frmActividades.valid||i.frmActividades.hasError("fechasInvalidas"))}}function Ot(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"button",71),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.actualizar())}),t._uU(1," Actualizar "),t.qZA()}if(2&e){const i=t.oxw();t.Q6J("disabled",!i.frmActividades.valid||i.frmActividades.hasError("fechasInvalidas"))}}const St=function(){return[10,20,30]};let Nt=(()=>{class e{constructor(i,a,o,h,m,C,f,Z,D){this.services=i,this.fb=a,this.evid=o,this.router=h,this.asigna=m,this.login=C,this.criteriosService=f,this.notificationService=Z,this.paginatorIntl=D,this.searchText="",this.actividad=new g.D,this.Actividades=[],this.guardadoExitoso=!1,this.noti=new _.U,this.user=null,this.idusuario=null,this.nombre=null,this.nombreact=null,this.crear=!0,this.ocultar=!1,this.isLoggedIn=!1,this.dataSource=new d.by,this.displayedColumns=["ID","NOMBRE","DESCRIPCI\xd3N","FECHA DE INICIO","FECHA FINALIZACION","ESTADO","observacion","Subir evidencia","ACCI\xd3N"],this.evi=new v.v,this.idevi=0,this.evide=0,this.archivo=new A,this.fechaMinima="",this.fechaMax="",this.datasource=[],this.filterPost="",this.frmActividades=a.group({nombre:["",p.kI.required],descripcion:["",[p.kI.required,p.kI.maxLength(250)]],fecha_inicio:["",p.kI.required],fecha_fin:["",p.kI.required]}),this.paginatorIntl.nextPageLabel="Siguiente",this.paginatorIntl.lastPageLabel="\xdaltima",this.paginatorIntl.itemsPerPageLabel="Actividades por p\xe1gina",this.paginatorIntl.previousPageLabel="Anterior",this.paginatorIntl.firstPageLabel="Primera",this.paginatorIntl.getRangeLabel=(U,I,T)=>{if(0==T||0==I)return`0 de ${T}`;const y=U*I;return`${y+1} - ${y<(T=Math.max(T,0))?Math.min(y+I,T):y+I} de ${T}`}}ngOnInit(){const i=localStorage.getItem("eviden");this.id_ev=Number(i),console.log("traido ev "+i),this.modeloMax(),setInterval(()=>{this.calcularfecha()},36e5),this.isLoggedIn=this.login.isLoggedIn(),this.user=this.login.getUser(),this.idusuario=this.user.id,console.log("usuar "+this.idusuario),this.login.loginStatusSubjec.asObservable().subscribe(a=>{this.isLoggedIn=this.login.isLoggedIn(),this.user=this.login.getUser()})}modeloMax(){this.criteriosService.getModeMaximo().subscribe(i=>{this.id_modelo=i.id_modelo,this.inicio()})}inicio(){if(0!=this.id_ev)this.evid.buscar(this.id_ev).subscribe(i=>{this.evi=i,this.listar(),this.fechaminima()});else{const i=history.state.data;this.id_ev=i,this.evid.buscar(this.id_ev).subscribe(a=>{this.evi=a,this.listar(),this.fechaminima()})}}getColorEstado(i){switch(i.toLowerCase()){case"pendiente":return"estado-pendiente";case"aprobada":return"estado-aprobada";case"rechazada":return"estado-rechazada";default:return""}}notificar(){this.noti.fecha=new Date,this.noti.rol="SUPERADMIN",this.noti.mensaje=this.user.persona.primer_nombre+" "+this.user.persona.primer_apellido+" ha creado la actividad "+this.nombreacti,this.noti.visto=!1,this.noti.usuario=0,this.noti.url="/sup/detalle",this.noti.idactividad=this.idevidencia,this.notificationService.crear(this.noti).subscribe(i=>{this.noti=i,console.log("Notificacion guardada")},i=>{console.error("No se pudo guardar la notificaci\xf3n",i)})}notificaradmin(){this.noti.fecha=new Date,this.noti.rol="ADMIN",this.noti.mensaje=this.user.persona.primer_nombre+" "+this.user.persona.primer_apellido+" ha creado la actividad "+this.nombreacti,this.noti.visto=!1,this.noti.usuario=0,this.noti.url="/adm/detalleAprobarRechazar",this.noti.idactividad=this.idevidencia,this.notificationService.crear(this.noti).subscribe(i=>{this.noti=i,console.log("Notificacion guardada")},i=>{console.error("No se pudo guardar la notificaci\xf3n",i)})}validarFechas(){const i=this.frmActividades.get("fecha_inicio")?.value,a=this.frmActividades.get("fecha_fin")?.value;if(i&&a){const o=new Date(i);new Date(a)<o?this.frmActividades.setErrors({fechasInvalidas:!0}):this.frmActividades.setErrors(null)}}guardar(){this.actividad=this.frmActividades.value,console.log("Nombre actividad: "+this.actividad.nombre),this.nombreacti=this.actividad.nombre,this.actividad.evidencia=this.evi,this.idevidencia=this.evi.id_evidencia,this.actividad.usuario=this.idusuario,this.actividad.estado="pendiente",this.services.crear(this.actividad).subscribe(i=>{console.log("creado con \xe9xito:",i),this.guardadoExitoso=!0,this.notificar(),this.notificaradmin(),this.listar(),c().fire({title:"Guardado con \xe9xito",text:"La actividad ha sido guardada satisfactoriamente",icon:"success",confirmButtonText:"Ok"})},i=>{console.error("Error al crear:",i),c().fire({title:"Error al guardar",text:"Ocurri\xf3 un error al guardar la actividad",icon:"error",confirmButtonText:"Ok"})})}editDatos(i){this.actividad=i,this.frmActividades=new p.cw({nombre:new p.NI(i.nombre),descripcion:new p.NI(i.descripcion),fecha_inicio:new p.NI(i.fecha_inicio),fecha_fin:new p.NI(i.fecha_fin)})}listar(){console.log("IDS: "+this.user.username+" id "+this.id_ev+" idevidencia "+this.evi.id_evidencia),this.services.getactivievid(this.user.username,this.id_ev).subscribe(i=>{const a=i;this.Actividades=a,a.forEach(o=>{this.services.getObservaciones(o.id_actividad).subscribe(h=>{o.observacion=h.map(m=>m.observacion)},h=>{console.error("Error al obtener observaciones:",h)})}),this.dataSource.data=this.Actividades,this.dataSource.paginator=this.paginator},i=>{console.error("Error al obtener actividades:",i)})}eliminar(i){c().fire({title:"\xbfEst\xe1 seguro?",text:"Esta acci\xf3n no se puede deshacer",icon:"warning",showCancelButton:!0,confirmButtonText:"Eliminar",cancelButtonText:"Cancelar"}).then(a=>{a.isConfirmed&&this.services.eliminar(i).subscribe(o=>{this.listar(),c().fire({title:"Eliminado",text:"El registro ha sido eliminado correctamente",icon:"success",confirmButtonText:"Ok"})},o=>{console.error("Error al eliminar:",o),c().fire({title:"Error al eliminar",text:"Ocurri\xf3 un error al eliminar el registro",icon:"error",confirmButtonText:"Ok"})})})}limpiarFormulario(){this.frmActividades.reset(),this.actividad=new g.D}actualizar(){this.actividad.nombre=this.frmActividades.value.nombre,this.actividad.descripcion=this.frmActividades.value.descripcion,this.actividad.fecha_inicio=this.frmActividades.value.fecha_inicio,this.actividad.fecha_fin=this.frmActividades.value.fecha_fin,this.actividad.usuario=null,console.log(this.actividad),this.services.update(this.actividad.id_actividad,this.actividad).subscribe(i=>{this.actividad=new g.D,this.listar(),c().fire("Operacion exitosa!","El registro se actualizo con exito","success")})}verDetalles(i){console.log("acti arc "+i.evidencia.id_evidencia),this.router.navigate(["/res/evidenciaResponsable"],{state:{data:i}})}calcularfecha(){this.services.geteviasig(this.user.username).subscribe(i=>{this.Actividades=i;const a=new Date;this.Actividades.forEach(o=>{const h=new Date(o.fecha_fin);if(h>=a){const m=h.getTime()-a.getTime(),C=Math.ceil(m/864e5);C<=3&&c().fire({title:`Actividad "${o.nombre}"`,text:`Faltan ${C} d\xedas para que se cumpla la fecha de finalizaci\xf3n.`,icon:"warning",position:"top-end",toast:!0,timer:3e3,timerProgressBar:!0,showConfirmButton:!1,customClass:{title:"custom-title",popup:"custom-popup",icon:"custom-icon",confirmButton:"custom-button"}})}})})}fechaminima(){let i=new Date;this.asigna.getfechaAsignacion(this.id_ev,this.id_modelo).pipe((0,Y.w)(a=>{console.log("Fecha "+JSON.stringify(a));const o=new Date(a.fecha_inicio);this.fechaMinima=o.toISOString().split("T")[0];const h=new Date(a.fecha_fin);return this.fechaMax=h.toISOString().split("T")[0],this.crear=i<=h,(0,K.of)(null)})).subscribe()}aplicarFiltro(){if(this.filterPost){const i=this.filterPost.toLowerCase();this.dataSource.data=this.dataSource.data.filter(a=>JSON.stringify(a).toLowerCase().includes(i))}else this.listar()}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(W._),t.Y36(p.qu),t.Y36(j.u),t.Y36(u.F0),t.Y36(V.Z),t.Y36(S.r),t.Y36(P.X),t.Y36(B.U),t.Y36(x.ye))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-actividades-responsable"]],viewQuery:function(i,a){if(1&i&&(t.Gf(X,5),t.Gf(x.NW,5)),2&i){let o;t.iGM(o=t.CRH())&&(a.datosModalRef=o.first),t.iGM(o=t.CRH())&&(a.paginator=o.first)}},decls:82,vars:20,consts:[[1,"container","bg-light","border","border-start-0","rounded-4"],[1,"blockquote","text-dark",2,"margin-top","5%"],[1,"card"],[1,"card-body"],["role","search","id","buscar"],["type","text","name","filterPost3","placeholder","Buscar...",1,"form-control",3,"ngModel","ngModelChange","input"],["type","button","class","btn btn-primary","data-bs-toggle","modal","data-bs-target","#materiaModal",4,"ngIf"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","ID"],["mat-header-cell","",3,"display",4,"matHeaderCellDef"],["mat-cell","",3,"display",4,"matCellDef"],["matColumnDef","NOMBRE"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","DESCRIPCI\xd3N"],["matColumnDef","FECHA DE INICIO"],["matColumnDef","FECHA FINALIZACION"],["matColumnDef","ESTADO"],["mat-cell","",3,"ngClass",4,"matCellDef"],["matColumnDef","observacion"],["matColumnDef","Subir evidencia"],["matColumnDef","ACCI\xd3N"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","Seleccione",3,"pageSizeOptions"],["paginator",""],["id","materiaModal","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade",3,"hidden.bs.modal"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header","bg-blue"],[1,"modal-title"],[1,"fas","fa-clipboard"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],["id","formulario",3,"formGroup","ngSubmit"],["for","nombre"],["formControlName","nombre","type","text","id","nombre","name","nombre",1,"form-control",2,"margin-bottom","10px"],["class","alert alert-danger",4,"ngIf"],["for","descripcion"],["formControlName","descripcion","id","descripcion","name","descripcion",1,"form-control",2,"margin-bottom","10px"],[1,"form-group"],["for","fecha_inicio"],[1,"input-group"],["type","date","id","fecha_inicio","name","fecha_inicio","formControlName","fecha_inicio",1,"form-control",3,"min","max","change"],["for","fecha_fin"],["type","date","id","fecha_fin","name","fecha_fin","formControlName","fecha_fin",1,"form-control",3,"min","max","change"],[1,"modal-footer"],["type","button","form","formulario","data-bs-dismiss","modal",1,"btn","btn-warning"],["type","submit","class","btn btn-primary","form","formulario","data-dismiss","modal","data-bs-dismiss","modal",3,"disabled",4,"ngIf"],["class","btn btn-primary","data-dismiss","modal","data-bs-dismiss","modal",3,"disabled","click",4,"ngIf"],["type","button","data-bs-toggle","modal","data-bs-target","#materiaModal",1,"btn","btn-primary"],["mat-header-cell",""],["mat-cell",""],["mat-cell","",3,"ngClass"],[4,"ngFor","ngForOf"],["role","button",1,"btn","btn-primary",3,"click"],[1,"d-flex"],[1,"badge"],[1,"fa","fa-folder-open"],["role","group",1,"btn-group"],["type","button","class","btn btn-primary","style","margin-right: 5%","data-bs-toggle","modal","data-bs-target","#materiaModal",3,"click",4,"ngIf"],["class","btn btn-danger","style","background-color: red; margin-right: 5%","role","button",3,"click",4,"ngIf"],["type","button","data-bs-toggle","modal","data-bs-target","#materiaModal",1,"btn","btn-primary",2,"margin-right","5%",3,"click"],[1,"fas","fa-edit"],["role","button",1,"btn","btn-danger",2,"background-color","red","margin-right","5%",3,"click"],[1,"fa","fa-trash"],["mat-header-row",""],["mat-row",""],[1,"alert","alert-danger"],[4,"ngIf"],["type","submit","form","formulario","data-dismiss","modal","data-bs-dismiss","modal",1,"btn","btn-primary",3,"disabled"],["data-dismiss","modal","data-bs-dismiss","modal",1,"btn","btn-primary",3,"disabled","click"]],template:function(i,a){1&i&&(t.TgZ(0,"div",0)(1,"blockquote",1)(2,"h1")(3,"strong"),t._uU(4," LISTADO ACTIVIDADES"),t.qZA()()(),t._UZ(5,"div"),t.TgZ(6,"div",2)(7,"div",3)(8,"div",4)(9,"input",5),t.NdJ("ngModelChange",function(h){return a.filterPost=h})("input",function(){return a.aplicarFiltro()}),t.qZA()(),t._UZ(10,"br"),t.YNc(11,tt,2,0,"button",6),t._UZ(12,"br")(13,"br"),t.TgZ(14,"table",7),t.ALo(15,"buscar"),t.ynx(16,8),t.YNc(17,it,2,2,"th",9),t.YNc(18,et,2,3,"td",10),t.BQk(),t.ynx(19,11),t.YNc(20,at,2,0,"th",12),t.YNc(21,ot,2,1,"td",13),t.BQk(),t.ynx(22,14),t.YNc(23,rt,2,0,"th",12),t.YNc(24,nt,2,1,"td",13),t.BQk(),t.ynx(25,15),t.YNc(26,st,2,0,"th",12),t.YNc(27,ct,3,4,"td",13),t.BQk(),t.ynx(28,16),t.YNc(29,dt,2,0,"th",12),t.YNc(30,lt,3,4,"td",13),t.BQk(),t.ynx(31,17),t.YNc(32,ut,2,0,"th",12),t.YNc(33,ht,2,2,"td",18),t.BQk(),t.ynx(34,19),t.YNc(35,pt,2,0,"th",12),t.YNc(36,mt,2,1,"td",13),t.BQk(),t.ynx(37,20),t.YNc(38,vt,2,0,"th",12),t.YNc(39,gt,5,0,"td",13),t.BQk(),t.ynx(40,21),t.YNc(41,ft,2,0,"th",12),t.YNc(42,At,4,2,"td",13),t.BQk(),t.YNc(43,xt,1,0,"tr",22),t.YNc(44,Zt,1,0,"tr",23),t.qZA(),t._UZ(45,"mat-paginator",24,25),t.TgZ(47,"div",26),t.NdJ("hidden.bs.modal",function(){return a.limpiarFormulario()}),t.TgZ(48,"div",27)(49,"div",28)(50,"div",29)(51,"h3",30),t._UZ(52,"i",31),t._uU(53," Actividades "),t.qZA(),t._UZ(54,"button",32),t.qZA(),t.TgZ(55,"div",33)(56,"form",34),t.NdJ("ngSubmit",function(){return a.guardar()}),t.TgZ(57,"div")(58,"label",35),t._uU(59,"Nombre:"),t.qZA(),t._UZ(60,"input",36),t.YNc(61,Dt,2,1,"div",37),t.TgZ(62,"label",38),t._uU(63,"Descripci\xf3n:"),t.qZA(),t._UZ(64,"textarea",39),t.YNc(65,yt,3,2,"div",37),t.TgZ(66,"div",40)(67,"label",41),t._uU(68,"Fecha de inicio:"),t.qZA(),t.TgZ(69,"div",42)(70,"input",43),t.NdJ("change",function(){return a.validarFechas()}),t.qZA()()(),t.TgZ(71,"div",40)(72,"label",44),t._uU(73,"Fecha de finalizar:"),t.qZA(),t.TgZ(74,"div",42)(75,"input",45),t.NdJ("change",function(){return a.validarFechas()}),t.qZA()(),t.YNc(76,Ut,2,0,"div",37),t.qZA()()(),t.TgZ(77,"div",46)(78,"button",47),t._uU(79," Cancelar "),t.qZA(),t.YNc(80,Mt,2,1,"button",48),t.YNc(81,Ot,2,1,"button",49),t.qZA()()()()()()()()),2&i&&(t.xp6(9),t.Q6J("ngModel",a.filterPost),t.xp6(2),t.Q6J("ngIf",a.crear),t.xp6(3),t.Q6J("dataSource",t.xi3(15,16,a.dataSource,a.filterPost)),t.xp6(29),t.Q6J("matHeaderRowDef",a.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",a.displayedColumns),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(19,St)),t.xp6(11),t.Q6J("formGroup",a.frmActividades),t.xp6(5),t.Q6J("ngIf",a.frmActividades.controls.nombre.invalid&&a.frmActividades.controls.nombre.touched),t.xp6(4),t.Q6J("ngIf",a.frmActividades.controls.descripcion.invalid&&a.frmActividades.controls.descripcion.touched),t.xp6(5),t.Q6J("min",a.fechaMinima)("max",a.fechaMax),t.xp6(5),t.Q6J("min",a.fechaMinima)("max",a.fechaMax),t.xp6(1),t.Q6J("ngIf",a.frmActividades.hasError("fechasInvalidas")),t.xp6(4),t.Q6J("ngIf",!a.actividad.id_actividad),t.xp6(1),t.Q6J("ngIf",a.actividad.id_actividad))},dependencies:[l.mk,l.sg,l.O5,p._Y,p.Fj,p.JJ,p.JL,p.On,p.sg,p.u,x.NW,d.BZ,d.fO,d.as,d.w1,d.Dz,d.nj,d.ge,d.ev,d.XQ,d.Gk,l.uU,$.o],styles:[".estado-pendiente[_ngcontent-%COMP%]{background-color:#ff0;color:#00f}.estado-aprobada[_ngcontent-%COMP%]{background-color:green;color:#fff}.estado-rechazada[_ngcontent-%COMP%]{background-color:red;color:#fff}"]}),e})();var Rt=s(3891);const wt=["fileInput"];function Pt(e,r){if(1&e&&(t.TgZ(0,"mat-header-cell"),t._uU(1,"ID"),t.qZA()),2&e){const i=t.oxw();t.Udp("display",i.ocultar?"":"none")}}function $t(e,r){if(1&e&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&e){const i=r.$implicit,a=t.oxw();t.Udp("display",a.ocultar?"":"none"),t.xp6(1),t.Oqu(i.id_archivo)}}function qt(e,r){1&e&&(t.TgZ(0,"mat-header-cell"),t._uU(1,"Evidencia"),t.qZA())}function Yt(e,r){if(1&e&&(t.TgZ(0,"mat-cell")(1,"a",27),t._uU(2),t.qZA()()),2&e){const i=r.$implicit;t.xp6(1),t.Q6J("href",i.enlace,t.LSH),t.xp6(1),t.Oqu(i.nombre)}}function kt(e,r){1&e&&(t.TgZ(0,"mat-header-cell"),t._uU(1,"Descripcion"),t.qZA())}function Lt(e,r){if(1&e&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&e){const i=r.$implicit;t.xp6(1),t.Oqu(i.descripcion)}}function jt(e,r){if(1&e&&(t.TgZ(0,"mat-header-cell"),t._uU(1,"Borrar"),t.qZA()),2&e){const i=t.oxw();t.Udp("display",i.veri?"":"none")}}function Bt(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"mat-cell")(1,"button",28),t.NdJ("click",function(){const h=t.CHM(i).$implicit,m=t.oxw();return t.KtG(m.elim(h.nombre,h))}),t._UZ(2,"i",29),t.qZA()()}if(2&e){const i=t.oxw();t.Udp("display",i.veri?"":"none")}}function Ft(e,r){1&e&&t._UZ(0,"mat-header-row")}function Qt(e,r){1&e&&t._UZ(0,"mat-row")}function Jt(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.onUpload())}),t._uU(1," Subir archivo "),t.qZA()}if(2&e){const i=t.oxw();t.Q6J("disabled",!i.filearchivo)}}const Gt=function(){return[5,10,20]};let Ht=(()=>{class e{ngAfterViewInit(){console.log("Paginator:",this.paginator),this.paginator&&(this.dataSource.paginator=this.paginator)}constructor(i,a,o,h,m){this.archivo=i,this.login=a,this.notificationService=o,this.fb=h,this.router=m,this.mensaje="",this.progressInfo=[],this.filename="",this.evidencias=[],this.Archivos=[],this.Actividades=[],this.noti=new _.U,this.idusuario=null,this.nombre=null,this.progreso=0,this.archivos=new A,this.user=null,this.isLoggedIn=!1,this.searchText="",this.dataSource=new d.by,this.displayedColumns=["Id","Evidencia","Descripcion","Borrar"],this.ocultar=!0,this.activ=new g.D,this.archi=new A,this.estad="",this.veri=!0,this.descripcion="",this.filterPost="",this.formulario=this.fb.group({descripcion:["",p.kI.required]})}onFileChange(i){i.target.files.length>0&&(this.filearchivo=i.target.files[0])}ngOnInit(){const i=history.state.data;this.activ=i,null!=this.activ?.evidencia?.id_evidencia&&(this.idevidencia=this.activ.evidencia.id_evidencia,this.estad=this.activ.estado,"Aprobada"==this.estad&&(this.veri=!1),console.log("acti recibido "+this.idevidencia+" estado "+this.estad)),null==this.activ&&(this.router.navigate(["user-dashboard"]),location.replace("/use/user-dashboard")),history,this.archi=i,null==this.archi&&(this.router.navigate(["user-dashboard"]),location.replace("/use/user-dashboard")),this.isLoggedIn=this.login.isLoggedIn(),this.user=this.login.getUser(),this.login.loginStatusSubjec.asObservable().subscribe(o=>{this.isLoggedIn=this.login.isLoggedIn(),this.user=this.login.getUser()}),this.listar()}mostra(){this.fileInfos=this.archivo.listar()}listar(){this.archivo.geteviasig(this.user.username).subscribe(i=>{this.aRCHI=i.filter(a=>a.actividad?.id_actividad===this.activ.id_actividad),this.dataSource.data=i.filter(a=>a.actividad?.id_actividad===this.activ.id_actividad)})}notificar(){this.noti.fecha=new Date,this.noti.rol="SUPERADMIN",this.noti.mensaje=this.user.persona.primer_nombre+" "+this.user.persona.primer_apellido+" ha subido un archivo para la actividad "+this.activ.nombre,this.noti.visto=!1,this.noti.usuario=0,this.noti.url="/sup/detalle",this.noti.idactividad=this.idevidencia,this.notificationService.crear(this.noti).subscribe(i=>{this.noti=i,console.log("Notificacion guardada")},i=>{console.error("No se pudo guardar la notificaci\xf3n",i)})}notificaradmin(){this.noti.fecha=new Date,this.noti.rol="ADMIN",this.noti.mensaje=this.user.persona.primer_nombre+" "+this.user.persona.primer_apellido+" ha subido un archivo para la actividad "+this.activ.nombre,this.noti.visto=!1,this.noti.usuario=0,this.noti.url="/adm/detalleAprobarRechazar",this.noti.idactividad=this.idevidencia,this.notificationService.crear(this.noti).subscribe(i=>{this.noti=i,console.log("Notificacion guardada")},i=>{console.error("No se pudo guardar la notificaci\xf3n",i)})}eliminar(i){this.archivo.borrar(i).subscribe(a=>{this.fileInfos=this.archivo.listar()})}elim(i,a){c().fire({title:"Confirmaci\xf3n",text:"\xbfEst\xe1s seguro de que quieres eliminar "+i+"?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar"}).then(o=>{o.isConfirmed&&(this.eliminar(i),console.log(a),this.eliminarlog(a),c().fire("Eliminado",i+" ha sido eliminado correctamente.","success"))})}onUpload(){this.archivo.cargar(this.filearchivo,this.descripcion,this.activ.id_actividad).subscribe(i=>{console.log("Archivo subido:"),c().fire({title:"\xa1\xc9xito!",text:"El archivo se ha subido correctamente",icon:"success",confirmButtonText:"OK"}),this.descripcion="",this.listar()},i=>{console.error("Error al subir el archivo:",i),c().fire({title:"\xa1Error!",text:"Nombre del archivo repetido",icon:"error",confirmButtonText:"OK"})}),this.notificar(),this.notificaradmin()}eliminarlog(i){this.archivo.eliminar(i).subscribe(a=>{this.listar()},a=>{console.error("Error al eliminar:",a)})}aplicarFiltro(){if(this.filterPost){const i=this.filterPost.toLowerCase();this.dataSource.data=this.dataSource.data.filter(a=>JSON.stringify(a).toLowerCase().includes(i))}else this.listar()}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(Rt.g),t.Y36(S.r),t.Y36(B.U),t.Y36(p.qu),t.Y36(u.F0))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-evidencias"]],viewQuery:function(i,a){if(1&i&&(t.Gf(x.NW,5),t.Gf(wt,5)),2&i){let o;t.iGM(o=t.CRH())&&(a.paginator=o.first),t.iGM(o=t.CRH())&&(a.fileInput=o.first)}},decls:42,vars:12,consts:[[1,"card"],[2,"padding","10px","text-align","center"],[1,"card-body"],["role","search","id","buscar"],["type","text","name","filterPost3","placeholder","Buscar...",1,"form-control",3,"ngModel","ngModelChange","input"],[1,"row"],[1,"col-md-8"],[1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","Id"],[3,"display",4,"matHeaderCellDef"],[3,"display",4,"matCellDef"],["matColumnDef","Evidencia"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","Descripcion"],["matColumnDef","Borrar"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],[1,"col-md-4"],[1,"form-group"],["id","id_evidencia"],["for","archivo"],["id","archivo","type","file",3,"change"],["for","descripcion"],["id","descripcion",1,"form-control",3,"ngModel","ngModelChange"],["class","btn btn-primary","type","button",3,"disabled","click",4,"ngIf"],[3,"href"],["role","button",1,"btn","btn-danger",2,"background-color","red","margin-right","5%",3,"click"],[1,"fa","fa-trash"],["type","button",1,"btn","btn-primary",3,"disabled","click"]],template:function(i,a){1&i&&(t.TgZ(0,"body")(1,"div",0)(2,"h1",1)(3,"strong"),t._uU(4,"Listado de Archivos"),t.qZA()(),t.TgZ(5,"div",2)(6,"div",3)(7,"input",4),t.NdJ("ngModelChange",function(h){return a.filterPost=h})("input",function(){return a.aplicarFiltro()}),t.qZA()(),t.TgZ(8,"div",5)(9,"div",6)(10,"mat-table",7),t.ALo(11,"buscar"),t.ynx(12,8),t.YNc(13,Pt,2,2,"mat-header-cell",9),t.YNc(14,$t,2,3,"mat-cell",10),t.BQk(),t.ynx(15,11),t.YNc(16,qt,2,0,"mat-header-cell",12),t.YNc(17,Yt,3,2,"mat-cell",13),t.BQk(),t.ynx(18,14),t.YNc(19,kt,2,0,"mat-header-cell",12),t.YNc(20,Lt,2,1,"mat-cell",13),t.BQk(),t.ynx(21,15),t.YNc(22,jt,2,2,"mat-header-cell",9),t.YNc(23,Bt,3,2,"mat-cell",10),t.BQk(),t.YNc(24,Ft,1,0,"mat-header-row",16),t.YNc(25,Qt,1,0,"mat-row",17),t.qZA(),t._UZ(26,"mat-paginator",18),t.qZA(),t.TgZ(27,"div",19)(28,"div",20),t._UZ(29,"br"),t.TgZ(30,"div",20)(31,"label",21),t._uU(32),t.qZA()(),t.TgZ(33,"div",20)(34,"label",22),t._uU(35,"Archivo:"),t.qZA(),t.TgZ(36,"input",23),t.NdJ("change",function(h){return a.onFileChange(h)}),t.qZA()(),t.TgZ(37,"div",20)(38,"label",24),t._uU(39,"Descripci\xf3n:"),t.qZA(),t.TgZ(40,"textarea",25),t.NdJ("ngModelChange",function(h){return a.descripcion=h}),t.qZA()(),t.YNc(41,Jt,2,1,"button",26),t.qZA()()()()()()),2&i&&(t.xp6(7),t.Q6J("ngModel",a.filterPost),t.xp6(3),t.Q6J("dataSource",t.xi3(11,8,a.dataSource,a.filterPost)),t.xp6(14),t.Q6J("matHeaderRowDef",a.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",a.displayedColumns),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(11,Gt)),t.xp6(6),t.hij("Actividad: ",a.activ.nombre,""),t.xp6(8),t.Q6J("ngModel",a.descripcion),t.xp6(1),t.Q6J("ngIf",a.veri))},dependencies:[l.O5,p.Fj,p.JJ,p.On,x.NW,d.BZ,d.fO,d.as,d.w1,d.Dz,d.nj,d.ge,d.ev,d.XQ,d.Gk,$.o]}),e})();var zt=s(8519),N=s(9921);function Kt(e,r){if(1&e&&(t.TgZ(0,"div")(1,"figure",1)(2,"blockquote",2)(3,"h1")(4,"strong"),t._uU(5),t.qZA()()()(),t.TgZ(6,"div",3)(7,"div"),t._UZ(8,"img",4),t.qZA()()()),2&e){const i=t.oxw();t.xp6(5),t.hij(" ",i.titulo," ")}}function Wt(e,r){if(1&e&&(t.TgZ(0,"th",28),t._uU(1,"ID"),t.qZA()),2&e){const i=t.oxw(2);t.Udp("display",i.ocultar?"":"none")}}function Vt(e,r){if(1&e&&(t.TgZ(0,"td",29),t._uU(1),t.qZA()),2&e){const i=r.$implicit,a=t.oxw(2);t.Udp("display",a.ocultar?"":"none"),t.xp6(1),t.Oqu(i.id_evidencia)}}function Xt(e,r){1&e&&(t.TgZ(0,"th",28),t._uU(1,"CRITERIO"),t.qZA())}function ti(e,r){if(1&e&&(t.TgZ(0,"td",29),t._uU(1),t.qZA()),2&e){const i=r.$implicit;t.xp6(1),t.Oqu(i.criterio)}}function ii(e,r){1&e&&(t.TgZ(0,"th",28),t._uU(1,"SUBCRITERIO"),t.qZA())}function ei(e,r){if(1&e&&(t.TgZ(0,"td",29),t._uU(1),t.qZA()),2&e){const i=r.$implicit;t.xp6(1),t.Oqu(i.subcriterio)}}function ai(e,r){1&e&&(t.TgZ(0,"th",28),t._uU(1,"INDICADOR"),t.qZA())}function oi(e,r){if(1&e&&(t.TgZ(0,"td",29),t._uU(1),t.qZA()),2&e){const i=r.$implicit;t.xp6(1),t.Oqu(i.indicador)}}function ri(e,r){1&e&&(t.TgZ(0,"th",28),t._uU(1,"ESTADO"),t.qZA())}function ni(e,r){if(1&e&&(t.TgZ(0,"td",30),t._uU(1),t.qZA()),2&e){const i=r.$implicit,a=t.oxw(2);t.Q6J("ngClass",a.getColorEstado(i.estado)),t.xp6(1),t.Oqu(i.estado.toUpperCase())}}function si(e,r){1&e&&(t.TgZ(0,"th",28),t._uU(1,"Descripci\xf3n"),t.qZA())}function ci(e,r){if(1&e&&(t.TgZ(0,"td",29),t._uU(1),t.qZA()),2&e){const i=r.$implicit;t.xp6(1),t.Oqu(i.descripcion)}}function di(e,r){1&e&&(t.TgZ(0,"th",28),t._uU(1,"Observaci\xf3n"),t.qZA())}function li(e,r){if(1&e&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&e){const i=r.$implicit;t.xp6(1),t.hij(" ",i," ")}}function ui(e,r){if(1&e&&(t.TgZ(0,"td",29),t.YNc(1,li,2,1,"div",31),t.qZA()),2&e){const i=r.$implicit;t.xp6(1),t.Q6J("ngForOf",i.observacion)}}function hi(e,r){1&e&&(t.TgZ(0,"th",28),t._uU(1,"Actividad"),t.qZA())}function pi(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"td",29)(1,"button",32),t.NdJ("click",function(){const h=t.CHM(i).$implicit,m=t.oxw(2);return t.KtG(m.verDetalles(h))}),t.TgZ(2,"div",33),t._UZ(3,"span",34)(4,"i",35),t.qZA()()()}if(2&e){const i=t.oxw(2);t.xp6(1),t.Q6J("disabled",i.botonDeshabilitado)}}function _i(e,r){1&e&&t._UZ(0,"tr",36)}function mi(e,r){1&e&&t._UZ(0,"tr",37)}const vi=function(){return[5,10,20]};function gi(e,r){if(1&e&&(t.TgZ(0,"div")(1,"div",5)(2,"div",6)(3,"figure",7)(4,"blockquote",2)(5,"h1")(6,"strong"),t._uU(7),t.qZA()()()(),t.TgZ(8,"div",8)(9,"div",9)(10,"div",10)(11,"table",11),t.ynx(12,12),t.YNc(13,Wt,2,2,"th",13),t.YNc(14,Vt,2,3,"td",14),t.BQk(),t.ynx(15,15),t.YNc(16,Xt,2,0,"th",16),t.YNc(17,ti,2,1,"td",17),t.BQk(),t.ynx(18,18),t.YNc(19,ii,2,0,"th",16),t.YNc(20,ei,2,1,"td",17),t.BQk(),t.ynx(21,19),t.YNc(22,ai,2,0,"th",16),t.YNc(23,oi,2,1,"td",17),t.BQk(),t.ynx(24,20),t.YNc(25,ri,2,0,"th",16),t.YNc(26,ni,2,2,"td",21),t.BQk(),t.ynx(27,22),t.YNc(28,si,2,0,"th",16),t.YNc(29,ci,2,1,"td",17),t.BQk(),t.ynx(30,23),t.YNc(31,di,2,0,"th",16),t.YNc(32,ui,2,1,"td",17),t.BQk(),t.ynx(33,24),t.YNc(34,hi,2,0,"th",16),t.YNc(35,pi,5,1,"td",17),t.BQk(),t.YNc(36,_i,1,0,"tr",25),t.YNc(37,mi,1,0,"tr",26),t.qZA(),t._UZ(38,"mat-paginator",27),t.qZA()()()()()()),2&e){const i=t.oxw();t.xp6(7),t.hij(" ",i.titulo," "),t.xp6(4),t.Q6J("dataSource",i.dataSource),t.xp6(25),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(5,vi))}}let fi=(()=>{class e{constructor(i,a,o,h,m,C,f){this.detaeva=i,this.login=a,this.httpCriterios=o,this.evidenciaService=h,this.modeloService=m,this.router=C,this.paginatorIntl=f,this.evidencias=[],this.verificar=!1,this.titulo="",this.ocultar=!1,this.dataSource=new d.by,this.displayedColumns=["ID","Criterio","Subcriterio","Indicador","Estado","Descripci\xf3n","observacion","Actividad"],this.isLoggedIn=this.login.isLoggedIn(),this.user=this.login.getUser(),this.paginatorIntl.nextPageLabel="Siguiente",this.paginatorIntl.lastPageLabel="\xdaltima",this.paginatorIntl.itemsPerPageLabel="\xcdtems por p\xe1gina",this.paginatorIntl.previousPageLabel="Anterior",this.paginatorIntl.firstPageLabel="Primera",this.paginatorIntl.getRangeLabel=(Z,D,U)=>{if(0==U||0==D)return`0 de ${U}`;const I=Z*D;return`${I+1} - ${I<(U=Math.max(U,0))?Math.min(I+D,U):I+D} de ${U}`}}ngOnInit(){this.login.loginStatusSubjec.asObservable().subscribe(i=>{this.isLoggedIn=this.login.isLoggedIn(),this.user=this.login.getUser()}),this.Inicio(),localStorage.removeItem("eviden")}Inicio(){this.httpCriterios.getModeMaximo().subscribe(i=>{this.id_modelo=i.id_modelo,console.log("ID modelo"+this.id_modelo),this.Listado()})}Listado(){this.evidenciaService.getevilist(this.user.username).subscribe(i=>{if(0!=i.length){this.verificar=!0,this.titulo="EVIDENCIAS ASIGNADAS";const a=i;this.evidencias=a,a.forEach(o=>{this.detaeva.getObservaciones(o.id_evidencia,this.id_modelo).subscribe(h=>{o.observacion=h.map(m=>m.observacion)})}),this.dataSource.data=this.evidencias,this.dataSource.paginator=this.paginator}else this.titulo="NO TIENES EVIDENCIAS ASIGNADAS"})}verDetalles(i){this.router.navigate(["/res/ActividadesResponsable"],{state:{data:i.id_evidencia}})}getColorEstado(i){switch(i.toLowerCase()){case"pendiente":return"estado-pendiente";case"aprobada":return"estado-aprobada";case"rechazada":return"estado-rechazada";default:return""}}verificarFechaLimite(){this.modeloService.getModeMaximo().subscribe(i=>{if(new Date>new Date(i.fecha_final_act))return this.botonDeshabilitado=!0,void this.mostrarMensaje("Ya no puede crear actividades porque ya paso la fecha l\xedmite.")})}mostrarMensaje(i){c().fire({title:"Advertencia",text:i,icon:"warning",confirmButtonText:"Aceptar"})}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(zt.u),t.Y36(S.r),t.Y36(P.X),t.Y36(j.u),t.Y36(N.y),t.Y36(u.F0),t.Y36(x.ye))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-evidencia-tareas-asginadas"]],viewQuery:function(i,a){if(1&i&&t.Gf(x.NW,5),2&i){let o;t.iGM(o=t.CRH())&&(a.paginator=o.first)}},decls:2,vars:2,consts:[[4,"ngIf"],[1,"text-center","text-dark",2,"margin-top","1%","font-style","italic"],[1,"blockquote","text-dark"],[1,"carousel-container"],["src","./assets/LOGO_CUADRADO_SIN FONDO.png","alt","Imagen 1"],[1,"container","bg-light","border","border-start-0","rounded-4"],[1,"container","text-center"],[1,"text-center","text-dark",2,"margin-top","5%","font-style","italic"],[1,"card"],[1,"card-body"],[1,"table-responsive"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","ID"],["mat-header-cell","",3,"display",4,"matHeaderCellDef"],["mat-cell","",3,"display",4,"matCellDef"],["matColumnDef","Criterio"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Subcriterio"],["matColumnDef","Indicador"],["matColumnDef","Estado"],["mat-cell","",3,"ngClass",4,"matCellDef"],["matColumnDef","Descripci\xf3n"],["matColumnDef","observacion"],["matColumnDef","Actividad"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell",""],["mat-cell",""],["mat-cell","",3,"ngClass"],[4,"ngFor","ngForOf"],["role","button",1,"btn","btn-primary",3,"disabled","click"],[1,"d-flex"],[1,"badge"],[1,"fa","fa-folder-open"],["mat-header-row",""],["mat-row",""]],template:function(i,a){1&i&&(t.YNc(0,Kt,9,1,"div",0),t.YNc(1,gi,39,6,"div",0)),2&i&&(t.Q6J("ngIf",!a.verificar),t.xp6(1),t.Q6J("ngIf",a.verificar))},dependencies:[l.mk,l.sg,l.O5,x.NW,d.BZ,d.fO,d.as,d.w1,d.Dz,d.nj,d.ge,d.ev,d.XQ,d.Gk],styles:[".tabla-container[_ngcontent-%COMP%]{max-height:750px;overflow-y:auto}.carousel-container[_ngcontent-%COMP%]{display:flex;overflow:hidden;width:300px;height:200px;margin:0 auto}.slide[_ngcontent-%COMP%]{flex:0 0 100%;transition:transform 1s ease}img[_ngcontent-%COMP%]{width:100%;height:100%}.imagen[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;max-height:100%;width:auto;height:auto;display:block;margin:0 auto;opacity:.5}.estado-pendiente[_ngcontent-%COMP%]{background-color:#ff0;color:#00f}.estado-aprobada[_ngcontent-%COMP%]{background-color:green;color:#fff}.estado-rechazada[_ngcontent-%COMP%]{background-color:red;color:#fff}.aprobado[_ngcontent-%COMP%]{color:green}.pendiente[_ngcontent-%COMP%]{color:#ff0}.rechazado[_ngcontent-%COMP%]{color:red}"]}),e})();var R=s(6884),bi=s(5412);function Ci(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"div",2)(1,"div",3)(2,"h3")(3,"b"),t._uU(4),t.qZA()(),t._UZ(5,"br"),t.TgZ(6,"b"),t._uU(7),t.ALo(8,"date"),t.qZA(),t._UZ(9,"br"),t.TgZ(10,"b"),t._uU(11),t.ALo(12,"date"),t.qZA(),t._UZ(13,"br"),t.TgZ(14,"a",4),t.NdJ("click",function(){const h=t.CHM(i).$implicit,m=t.oxw();return t.KtG(m.enviarModelo(h))}),t._uU(15,"Ver"),t.qZA()()()}if(2&e){const i=r.$implicit;t.xp6(4),t.Oqu(i.nombre),t.xp6(3),t.hij("Fecha Inicio: ",t.xi3(8,3,i.fecha_inicio,"dd/MM/yyyy"),""),t.xp6(4),t.hij("Fecha Fin: ",t.xi3(12,6,i.fecha_fin,"dd/MM/yyyy"),"")}}let Ai=(()=>{class e{constructor(i,a,o){this.dialog=i,this.router=a,this.modeloService=o,this.mode=new R.Z,this.datasource=[]}ngOnInit(){this.listar()}listar(){this.modeloService.listarModelo().subscribe(i=>{this.datasource=i})}irDetalle(i){this.router.navigate(["/res/detalleC"])}enviarModelo(i){localStorage.setItem("id",i.id_modelo.toString()),this.mode=i,this.router.navigate(["/res/detalleC"])}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(bi.uw),t.Y36(u.F0),t.Y36(N.y))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-actividad-criterio-modelo"]],decls:4,vars:1,consts:[[1,"container","bg-light","border","border-start-0","rounded-4"],["class","card",4,"ngFor","ngForOf"],[1,"card"],[1,"card-body"],[1,"btn","btn-primary",3,"click"]],template:function(i,a){1&i&&(t.TgZ(0,"body")(1,"div",0),t.YNc(2,Ci,16,9,"div",1),t._UZ(3,"br"),t.qZA()()),2&i&&(t.xp6(2),t.Q6J("ngForOf",a.datasource))},dependencies:[l.sg,l.uU],styles:[".card[_ngcontent-%COMP%]{border:1px solid #ccc;border-radius:5px;padding:10px;margin-bottom:10px}.card-body[_ngcontent-%COMP%]{font-family:Arial,sans-serif}.card-body[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;font-weight:700}.card-body[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{color:#555}body[_ngcontent-%COMP%]{font:1em/1.618 Inter,sans-serif;display:flex;align-items:center;justify-content:center;min-height:100vh;padding:30px;color:#224}"]}),e})();var M=s(7340),F=s(9541),Q=s(1282),q=s(6493),J=s(404),k=s(2986),L=s(1679),xi=s(4859);function Zi(e,r){1&e&&(t.TgZ(0,"div")(1,"figure",1)(2,"blockquote",2)(3,"h1")(4,"strong"),t._uU(5," No se te asignaron criterios"),t._UZ(6,"br"),t._uU(7,"en este modelo "),t.qZA()()()(),t.TgZ(8,"div",3)(9,"div"),t._UZ(10,"img",4),t.qZA()()())}function Ti(e,r){if(1&e&&(t.TgZ(0,"div")(1,"b"),t._uU(2),t.qZA(),t._UZ(3,"br"),t.TgZ(4,"b"),t._uU(5),t.qZA(),t._UZ(6,"br"),t.TgZ(7,"b"),t._uU(8),t.ALo(9,"date"),t.qZA(),t._UZ(10,"br"),t.TgZ(11,"b"),t._uU(12),t.ALo(13,"date"),t.qZA(),t._UZ(14,"br"),t.qZA()),2&e){const i=t.oxw(2);t.xp6(2),t.hij("ID: ",i.model.id_modelo,""),t.xp6(3),t.hij("NOMBRE: ",i.model.nombre,""),t.xp6(3),t.hij("FECHA INICIO: ",t.xi3(9,4,i.model.fecha_inicio,"dd/MM/yyyy"),""),t.xp6(4),t.hij("FECHA FIN: ",t.xi3(13,7,i.model.fecha_fin,"dd/MM/yyyy"),"")}}function Di(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"div",35),t.NdJ("click",function(){const h=t.CHM(i).$implicit,m=t.oxw(3);return t.KtG(m.fetchAndProcessData(h.nombre))}),t.TgZ(1,"div",36)(2,"div",36),t._uU(3),t.ALo(4,"number"),t.qZA(),t.TgZ(5,"div",37),t._uU(6),t.qZA(),t.TgZ(7,"div",38),t._uU(8),t.ALo(9,"number"),t.ALo(10,"number"),t.qZA()()()}if(2&e){const i=r.$implicit,a=r.index,o=t.oxw(3);t.Udp("background-color",o.coloresTarjetas[a])("border",o.borderStyles[a]),t.xp6(3),t.hij("",t.xi3(4,8,i.total/i.faltante*100,"1.0-2"),"%"),t.xp6(3),t.Oqu(i.nombre),t.xp6(2),t.AsE("Total: ",t.xi3(9,11,i.total,"1.2-4")," de ",t.xi3(10,14,i.faltante,"1.2-4"),"")}}function Ii(e,r){if(1&e&&(t.TgZ(0,"div",33),t.YNc(1,Di,11,17,"div",34),t.qZA()),2&e){const i=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",i.listain)}}function Ei(e,r){1&e&&(t.TgZ(0,"div",39),t._UZ(1,"img",40),t.qZA())}function yi(e,r){if(1&e&&(t.TgZ(0,"th",61),t._uU(1,"Criterio"),t.qZA()),2&e){const i=t.oxw(3);t.Udp("display",i.verCriterio?"":"none")}}function Ui(e,r){if(1&e&&(t.TgZ(0,"td",62),t._uU(1),t.qZA()),2&e){const i=r.$implicit,a=r.index,o=t.oxw(3);t.Udp("display",o.verCriterio&&o.getRowSpan3("Criterio",a)?"":"none")("background-color",o.getColorcelda("Criterio",.3)),t.uIk("rowspan",o.getRowSpan3("Criterio",a)),t.xp6(1),t.hij(" ",i.criterionomj," ")}}function Mi(e,r){if(1&e&&(t.TgZ(0,"th",61),t._uU(1,"Subcriterio"),t.qZA()),2&e){const i=t.oxw(3);t.Udp("display",i.verSubcriterio?"":"none")}}function Oi(e,r){if(1&e&&(t.TgZ(0,"td",62),t._uU(1),t.qZA()),2&e){const i=r.$implicit,a=r.index,o=t.oxw(3);t.Udp("background-color",i.randomColor)("display",o.verSubcriterio&&o.getRowSpan3("Subcriterio",a)?"":"none"),t.uIk("rowspan",o.getRowSpan3("Subcriterio",a)),t.xp6(1),t.hij(" ",i.subcrierioj," ")}}function Si(e,r){if(1&e&&(t.TgZ(0,"th",61),t._uU(1,"Indicador"),t.qZA()),2&e){const i=t.oxw(3);t.Udp("display",i.verIndicador?"":"none")}}function Ni(e,r){if(1&e&&(t.TgZ(0,"td",62),t._uU(1),t.qZA()),2&e){const i=r.$implicit,a=r.index,o=t.oxw(3);t.Udp("background-color",i.Colores)("display",o.verIndicador&&o.getRowSpan3("Indicador",a)?"":"none"),t.uIk("rowspan",o.getRowSpan3("Indicador",a)),t.xp6(1),t.AsE(" ",i.ind_nombrej," ",o.calcularRowSpanValue(a)," ")}}function Ri(e,r){if(1&e&&(t.TgZ(0,"th",61),t._uU(1,"Peso"),t.qZA()),2&e){const i=t.oxw(3);t.Udp("display",i.verPeso?"":"none")}}function wi(e,r){if(1&e&&(t.TgZ(0,"td",63),t._uU(1),t.qZA()),2&e){const i=r.$implicit,a=r.index,o=t.oxw(3);t.Udp("display",o.verPeso&&o.getRowSpan3("Peso",a)?"":"none"),t.uIk("rowspan",o.getRowSpan3("Peso",a)),t.xp6(1),t.hij(" ",i.pes," ")}}function Pi(e,r){if(1&e&&(t.TgZ(0,"th",61),t._uU(1,"% Obtenido"),t.qZA()),2&e){const i=t.oxw(3);t.Udp("display",i.verObtenido?"":"none")}}const $i=function(e,r,i,a){return{rojo:e,naranja:r,amarillo:i,verde:a}};function qi(e,r){if(1&e&&(t.TgZ(0,"td",64),t._uU(1),t.qZA()),2&e){const i=r.$implicit,a=r.index,o=t.oxw(3);t.Udp("display",o.verObtenido&&o.getRowSpan3("Obtenido",a)?"":"none"),t.Q6J("ngClass",t.l5B(5,$i,i.obt>=0&&i.obt<=25,i.obt>25&&i.obt<=50,i.obt>50&&i.obt<=75,i.obt>75&&i.obt<=100)),t.uIk("rowspan",o.getRowSpan3("Obtenido",a)),t.xp6(1),t.hij(" ",i.obt," ")}}function Yi(e,r){if(1&e&&(t.TgZ(0,"th",61),t._uU(1,"% Utilidad"),t.qZA()),2&e){const i=t.oxw(3);t.Udp("display",i.verUtilidad?"":"none")}}function ki(e,r){if(1&e&&(t.TgZ(0,"td",63),t._uU(1),t.qZA()),2&e){const i=r.$implicit,a=r.index,o=t.oxw(3);t.Udp("display",o.verUtilidad&&o.getRowSpan3("Utilidad",a)?"":"none"),t.uIk("rowspan",o.getRowSpan3("Utilidad",a)),t.xp6(1),t.hij(" ",i.uti," ")}}function Li(e,r){if(1&e&&(t.TgZ(0,"th",61),t._uU(1,"Valor"),t.qZA()),2&e){const i=t.oxw(3);t.Udp("display",i.verValor?"":"none")}}function ji(e,r){if(1&e&&(t.TgZ(0,"td",63),t._uU(1),t.qZA()),2&e){const i=r.$implicit,a=r.index,o=t.oxw(3);t.Udp("display",o.verValor&&o.getRowSpan3("Valor",a)?"":"none"),t.uIk("rowspan",o.getRowSpan3("Valor",a)),t.xp6(1),t.hij(" ",i.val," ")}}function Bi(e,r){if(1&e&&(t.TgZ(0,"th",61),t._uU(1,"Evidencia"),t.qZA()),2&e){const i=t.oxw(3);t.Udp("display",i.verEvidencia?"":"none")}}function Fi(e,r){if(1&e&&(t.TgZ(0,"td",65),t._uU(1),t.qZA()),2&e){const i=r.$implicit,a=r.index,o=t.oxw(3);t.Udp("background-color",i.indicol)("display",o.verEvidencia&&o.getRowSpan3("Evidencia",a)?"":"none"),t.uIk("rowspan",o.getRowSpan3("Evidencia",a)),t.xp6(1),t.hij(" ",i.descrip," ")}}function Qi(e,r){1&e&&t._UZ(0,"tr",66)}function Ji(e,r){1&e&&t._UZ(0,"tr",67)}function Gi(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"div")(1,"div",41)(2,"h3")(3,"span",16),t._uU(4,"Criterio Seleccionado:"),t.qZA(),t._uU(5),t.qZA(),t.TgZ(6,"div",42)(7,"button",43),t.NdJ("click",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.showCriterio())}),t._uU(8," Criterio "),t.qZA(),t.TgZ(9,"button",43),t.NdJ("click",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.showSubcriterio())}),t._uU(10," Subcriterio "),t.qZA(),t.TgZ(11,"button",43),t.NdJ("click",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.showIndicador())}),t._uU(12," Indicador "),t.qZA(),t.TgZ(13,"button",43),t.NdJ("click",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.showEvidencia())}),t._uU(14," Evidencia "),t.qZA(),t.TgZ(15,"button",43),t.NdJ("click",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.showPeso())}),t._uU(16," Peso "),t.qZA(),t.TgZ(17,"button",43),t.NdJ("click",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.showObtenido())}),t._uU(18," % Obte "),t.qZA(),t.TgZ(19,"button",43),t.NdJ("click",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.showUtilidad())}),t._uU(20," % Util "),t.qZA(),t.TgZ(21,"button",43),t.NdJ("click",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.showValor())}),t._uU(22," Valor "),t.qZA()()(),t.TgZ(23,"div",44)(24,"div",45)(25,"table",46),t.ynx(26,47),t.YNc(27,yi,2,2,"th",48),t.YNc(28,Ui,2,6,"td",49),t.BQk(),t.ynx(29,50),t.YNc(30,Mi,2,2,"th",48),t.YNc(31,Oi,2,6,"td",51),t.BQk(),t.ynx(32,52),t.YNc(33,Si,2,2,"th",48),t.YNc(34,Ni,2,7,"td",51),t.BQk(),t.ynx(35,53),t.YNc(36,Ri,2,2,"th",48),t.YNc(37,wi,2,4,"td",54),t.BQk(),t.ynx(38,55),t.YNc(39,Pi,2,2,"th",48),t.YNc(40,qi,2,10,"td",56),t.BQk(),t.ynx(41,57),t.YNc(42,Yi,2,2,"th",48),t.YNc(43,ki,2,4,"td",54),t.BQk(),t.ynx(44,58),t.YNc(45,Li,2,2,"th",48),t.YNc(46,ji,2,4,"td",54),t.BQk(),t.ynx(47,59),t.YNc(48,Bi,2,2,"th",48),t.YNc(49,Fi,2,6,"td",60),t.BQk(),t.YNc(50,Qi,1,0,"tr",26),t.YNc(51,Ji,1,0,"tr",27),t.qZA()()()()}if(2&e){const i=t.oxw(2);t.xp6(5),t.hij(" ",i.titulocriterio,""),t.xp6(2),t.Q6J("ngClass",i.verCriterio?"selected":""),t.xp6(2),t.Q6J("ngClass",i.verSubcriterio?"selected":""),t.xp6(2),t.Q6J("ngClass",i.verIndicador?"selected":""),t.xp6(2),t.Q6J("ngClass",i.verEvidencia?"selected":""),t.xp6(2),t.Q6J("ngClass",i.verPeso?"selected":""),t.xp6(2),t.Q6J("ngClass",i.verObtenido?"selected":""),t.xp6(2),t.Q6J("ngClass",i.verUtilidad?"selected":""),t.xp6(2),t.Q6J("ngClass",i.verValor?"selected":""),t.xp6(4),t.Q6J("dataSource",i.datacrite),t.xp6(25),t.Q6J("matHeaderRowDef",i.displayedColumns3),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns3)}}function Hi(e,r){1&e&&(t.TgZ(0,"th",68),t._uU(1," Indicadores "),t.qZA())}function zi(e,r){if(1&e&&(t.TgZ(0,"td",69),t._uU(1),t.qZA()),2&e){const i=r.$implicit,a=t.oxw(2);t.Udp("background-color",a.colores(i.color)),t.xp6(1),t.hij(" ",i.color.toUpperCase()," ")}}function Ki(e,r){1&e&&(t.TgZ(0,"th",70),t._uU(1," N\xb0 indi "),t.qZA())}function Wi(e,r){if(1&e&&(t.TgZ(0,"td",71),t._uU(1),t.qZA()),2&e){const i=r.$implicit;t.xp6(1),t.hij(" ",i.indica," ")}}function Vi(e,r){1&e&&(t.TgZ(0,"th",70),t._uU(1," % "),t.qZA())}function Xi(e,r){if(1&e&&(t.TgZ(0,"td",71),t._uU(1),t.qZA()),2&e){const i=r.$implicit;t.xp6(1),t.hij(" ",i.porcentaje,"% ")}}function te(e,r){1&e&&t._UZ(0,"tr",66)}function ie(e,r){1&e&&t._UZ(0,"tr",67)}function ee(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"div")(1,"div",5)(2,"div",6)(3,"h1",7),t._uU(4,"DETALLE DEL MODELO"),t.qZA(),t.TgZ(5,"h1"),t._uU(6,"Nombre del Modelo"),t.qZA(),t.YNc(7,Ti,15,10,"div",0),t.qZA(),t.YNc(8,Ii,2,1,"div",8),t.TgZ(9,"div",9)(10,"div",10),t.YNc(11,Ei,2,0,"div",11),t.YNc(12,Gi,52,12,"div",0),t.qZA(),t.TgZ(13,"div",12)(14,"div",13)(15,"div",14)(16,"div",15)(17,"h3",16),t._uU(18,"Estado de los indicadores"),t.qZA()(),t.TgZ(19,"table",17),t.ynx(20,18),t.YNc(21,Hi,2,0,"th",19),t.YNc(22,zi,2,3,"td",20),t.BQk(),t.ynx(23,21),t.YNc(24,Ki,2,0,"th",22),t.YNc(25,Wi,2,1,"td",23),t.BQk(),t.ynx(26,24),t.YNc(27,Vi,2,0,"th",25),t.YNc(28,Xi,2,1,"td",23),t.BQk(),t.YNc(29,te,1,0,"tr",26),t.YNc(30,ie,1,0,"tr",27),t.qZA()()()()(),t.TgZ(31,"div",9)(32,"div",10)(33,"h3",28),t._uU(34,"Grafica de Criterios"),t.qZA(),t.TgZ(35,"canvas",29),t.NdJ("chartClick",function(o){t.CHM(i);const h=t.oxw();return t.KtG(h.chartClicked(o))}),t.qZA()(),t.TgZ(36,"div",30)(37,"div",13)(38,"h3",31),t._uU(39,"Grafica de Indicadores"),t.qZA(),t._UZ(40,"canvas",32),t.qZA()()()()()}if(2&e){const i=t.oxw();t.xp6(7),t.Q6J("ngIf",i.model),t.xp6(1),t.Q6J("ngIf",i.listain),t.xp6(3),t.Q6J("ngIf",!i.clic),t.xp6(1),t.Q6J("ngIf",i.clic),t.xp6(7),t.Q6J("dataSource",i.tabla),t.xp6(10),t.Q6J("matHeaderRowDef",i.displayedColumns4),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns4),t.xp6(5),t.Q6J("data",i.barChartData)("options",i.barChartOptions)("plugins",i.barChartPlugins)("type",i.barChartType),t.xp6(5),t.Q6J("data",i.pieChartData)("type",i.pieChartType)("options",i.pieChartOptions)("plugins",i.pieChartPlugins)}}const G={verde:"#00FF00",naranja:"#FFA500",rojo:"#FF0000",amarillo:"#f8f32b"};let ae=(()=>{class e{chartClicked({event:i,active:a}){console.log(i,a)}chartHovered({event:i,active:a}){console.log(i,a)}constructor(i,a,o,h,m,C,f,Z,D,U){this.login=i,this.paginatorIntl=a,this.modeloService=o,this.indi=h,this.criterioService=m,this.subcriterioService=C,this.indicadorService=f,this.asignacionIndicadorService=Z,this.sharedDataService=D,this.router=U,this.itemsPerPageLabel="Items por p\xe1gina",this.nextPageLabel="Siguiente",this.lastPageLabel="\xdaltima",this.firstPageLabel="Primera",this.previousPageLabel="Anterior",this.rango=(I,T,y)=>{if(0==y||0==T)return`0 de ${y}`;const O=I*T;return`${O+1} - ${O<(y=Math.max(y,0))?Math.min(O+T,y):O+T} de ${y}`},this.columnNames={nombre:"Nombre del Criterio",descripcion:"Descripci\xf3n del Criterio"},this.displayedColumns3=["Criterio","Subcriterio","Indicador","Evidencia","Peso","Obtenido","Utilidad","Valor"],this.displayedColumns4=["indicadores","nindi","porcentaje"],this.consul=!1,this.verEvidencia=!1,this.verIndicador=!0,this.verPeso=!0,this.verObtenido=!0,this.verUtilidad=!0,this.verValor=!0,this.verSubcriterio=!0,this.verCriterio=!1,this.columnsToDisplay=["nombre","descripcion"],this.columnsToDisplayWithExpand=[...this.columnsToDisplay],this.clic=!1,this.valoresp=[],this.labesCriterios=[],this.datosPOrceCriter=[],this.valores=[],this.coloresTarjetas=[],this.borderStyles=[],this.listain=[],this.indicol=[],this.model=new R.Z,this.datacrite=[],this.spans3=[],this.rowSpanValue=0,this.coloresAsignados={},this.seleccionados={},this.todosSeleccionados=!1,this.rol="",this.user=null,this.isLoggedIn=!1,this.barChartOptions={responsive:!0,scales:{x:{type:"category",ticks:{autoSkip:!1,maxRotation:45,minRotation:45,color:"black"}},y:{}},plugins:{legend:{display:!0},datalabels:{anchor:"end",align:"end",color:"black"}}},this.barChartType="bar",this.barChartPlugins=[Q.Z],this.barChartData={labels:[],datasets:[{data:[],label:"V/Obtenido",backgroundColor:"rgba(56,116,188,255)"},{data:[],label:"V/por obtener",backgroundColor:"rgba(184,54,51,255)"}]},this.pieChartOptions={responsive:!0,plugins:{legend:{display:!0,position:"top"},datalabels:{formatter:(I,T)=>{if(T.chart.data.labels)return T.chart.data.labels[T.dataIndex]}},tooltip:{callbacks:{label:I=>`${I.raw}%`}}},elements:{arc:{backgroundColor:[]}}},this.pieChartData={labels:[],datasets:[{data:[]}]},this.pieChartType="pie",this.pieChartPlugins=[Q.Z],this.paginatorIntl.nextPageLabel=this.nextPageLabel,this.paginatorIntl.lastPageLabel=this.lastPageLabel,this.paginatorIntl.itemsPerPageLabel=this.itemsPerPageLabel,this.paginatorIntl.previousPageLabel=this.previousPageLabel,this.paginatorIntl.firstPageLabel=this.firstPageLabel,this.paginatorIntl.getRangeLabel=this.rango,this.rol=this.login.getUserRole()}ngOnInit(){this.isLoggedIn=this.login.isLoggedIn(),this.user=this.login.getUser(),console.log(" el usuario es "+this.user.id+" rol"+this.rol);let i=localStorage.getItem("id");this.id_modelo=Number(i),this.recibeModelo(),this.dataSource&&(this.dataSource.paginator=this.paginator)}recibeModelo(){this.modeloService.getModeloById(Number(this.id_modelo)).subscribe(i=>{this.model=i,this.asignacionIndicadorService.getAsignacionIndicadorByIdModelo(Number(this.id_modelo)).subscribe(a=>{this.criterioService.getCriterios().subscribe(o=>{this.asignacion=a,this.dataSource=o.filter(h=>a.some(m=>h.id_criterio===m.indicador.subcriterio.criterio.id_criterio)),this.dataSource.paginator=this.paginator})})}),this.listaind(),this.coloresPro(),this.valorespr()}listaind(){"ADMIN"==this.rol?this.criterioService.getIndicadorad(this.id_modelo,this.user.id).subscribe(i=>{this.listain=i,this.listain.forEach(a=>{this.coloresTarjetas.push(this.getRandomColor()),this.borderStyles.push(this.getBorderColor(a.faltante-a.total))}),0!=i.length&&(this.consul=!0),console.log("lista in "+this.listain)}):this.criterioService.getIndicador(this.id_modelo).subscribe(i=>{this.listain=i,this.listain.forEach(a=>{this.coloresTarjetas.push(this.getRandomColor()),this.borderStyles.push(this.getBorderColor(a.faltante-a.total))}),console.log("lista in "+this.listain)})}irPonderacionModelo(i){localStorage.setItem("id",i.id_modelo.toString()),console.log(i.id_modelo),this.model=i,this.router.navigate(["/sup/ponderacion/ponderacion-modelo"])}ponderacionCriterio(i,a){i.stopPropagation(),this.router.navigate(["/sup/ponderacion/ponderacion-criterio"],{queryParams:{criterio:a.id_criterio,modelo:this.id_modelo}})}mostrar(i){console.log(i),this.sharedDataService.agregarIdCriterio(i.id_criterio),this.router.navigate(["/res/criterio-subcriterio"])}evaluacion(i,a){i.stopPropagation(),this.router.navigate(["/sup/modelo/matriz-evaluacion"],{queryParams:{criterio:a.id_criterio,modelo:this.id_modelo}})}ponderacion(i,a){i.stopPropagation(),this.sharedDataService.agregarIdCriterio(a.id_criterio)}getRandomColor(){return`rgba(${Math.floor(256*Math.random())}, ${Math.floor(256*Math.random())}, ${Math.floor(256*Math.random())}, 0.3)`}getBorderColor(i){return`${100*i+"px"} solid ${this.getRandomColor()}`}fetchAndProcessData(i){this.titulocriterio=i,this.datacrite=[],this.spans3=[],this.clic=!0,""===this.titulocriterio&&(this.titulocriterio="ORGANIZACI\xd3N",i="ORGANIZACI\xd3N"),this.criterioService.getIdCriterio(i).subscribe(a=>{this.id_criterio=a.id_criterio,console.log("id crti: "+this.id_criterio)}),this.modeloService.getlisdescrite(this.id_modelo,i).subscribe(a=>{this.datacrite=a,this.datacrite.forEach(o=>{typeof this.seleccionados[o.criterionomj]>"u"&&(this.seleccionados[o.criterionomj]=!1)}),this.cacheSpan3("Criterio",o=>o.criterionomj),this.cacheSpan3("Subcriterio",o=>o.criterionomj+o.subcrierioj),this.cacheSpan3("Indicador",o=>o.criterionomj+o.subcrierioj+o.ind_nombrej),this.cacheSpan3("Peso",o=>o.criterionomj+o.subcrierioj+o.ind_nombrej+o.pes),this.cacheSpan3("Obtenido",o=>o.criterionomj+o.subcrierioj+o.ind_nombrej+o.pes+o.obt),this.cacheSpan3("Utilidad",o=>o.criterionomj+o.subcrierioj+o.ind_nombrej+o.pes+o.obt+o.uti),this.cacheSpan3("Valor",o=>o.criterionomj+o.subcrierioj+o.ind_nombrej+o.pes+o.obt+o.uti+o.val),this.cacheSpan3("Evidencia",o=>o.criterionomj+o.subcrierioj+o.ind_nombrej+o.pes+o.obt+o.uti+o.val+o.descrip),setTimeout(()=>{this.aplicar()},0)})}aplicar(){this.datacrite.forEach(i=>{i.randomColor=this.generarColor()}),this.datacrite.forEach(i=>{i.Colores=this.generarColor2()}),this.datacrite.forEach(i=>{i.indicol=this.generarColor3()})}generarColor(){return`rgba(${Math.floor(256*Math.random())}, ${Math.floor(256*Math.random())}, ${Math.floor(256*Math.random())}, 0.3)`}generarColor2(){return`rgba(${Math.floor(256*Math.random())}, ${Math.floor(256*Math.random())}, ${Math.floor(256*Math.random())}, 0.3)`}generarColor3(){return`rgba(${Math.floor(256*Math.random())}, ${Math.floor(256*Math.random())}, ${Math.floor(256*Math.random())}, 0.3)`}cacheSpan3(i,a){for(let o=0;o<this.datacrite.length;){let h=a(this.datacrite[o]),m=1;for(let C=o+1;C<this.datacrite.length&&h===a(this.datacrite[C]);C++)m++;this.spans3[o]||(this.spans3[o]={}),this.spans3[o][i]=m,o+=m}}getRowSpan3(i,a){return this.spans3[a]&&this.spans3[a][i]}showValor(){this.verValor=!this.verValor}showUtilidad(){this.verUtilidad=!this.verUtilidad}showObtenido(){this.verObtenido=!this.verObtenido}showCriterio(){this.verCriterio=!this.verCriterio}showSubcriterio(){this.verSubcriterio=!this.verSubcriterio}showIndicador(){this.verIndicador=!this.verIndicador}showPeso(){this.verPeso=!this.verPeso}showEvidencia(){this.verEvidencia=!this.verEvidencia}getColorcelda(i,a){if(!this.coloresAsignados[i]){const o=Math.floor(256*Math.random()),h=Math.floor(256*Math.random()),m=Math.floor(256*Math.random());this.coloresAsignados[i]=`rgba(${o}, ${h}, ${m}, ${a})`}return this.coloresAsignados[i]}calcularRowSpanValue(i){this.rowSpanValue=this.getRowSpan3("Indicador",i)}colores(i){switch(i){case"verde":return"green";case"amarillo":return"yellow";case"naranja":return"orange";case"rojo":return"red";case"Total":return"gray";default:return"transparent"}}coloresPro(){"ADMIN"==this.rol?this.indi.getIndicAdmin(this.id_modelo,this.user.id).subscribe(i=>{this.indicol=i,this.pieChartData.datasets[0].data=this.indicol.map(f=>f.porcentaje);const a={rojo:">=0",naranja:">25",amarillo:">50",verde:">75"},o=i.map(f=>f.color);this.pieChartData.labels=o.map(f=>a[f]),null!=this.pieChartOptions?.elements?.arc?.backgroundColor&&(this.pieChartOptions.elements.arc.backgroundColor=this.indicol.map(f=>G[f.color])),this.pieChartData={...this.pieChartData};const h=this.indicol.reduce((f,Z)=>f+Z.indica,0),m=this.indicol.reduce((f,Z)=>f+Z.porcentaje,0),C=Math.round(m);this.indicol.push({color:"Total",indica:h,porcentaje:C}),this.indicol.sort((f,Z)=>{const D=["verde","amarillo","naranja","rojo","Total"];return D.indexOf(f.color)-D.indexOf(Z.color)}),this.tabla=new d.by(this.indicol)}):this.indi.getIndicadorColProjection(this.id_modelo).subscribe(i=>{this.indicol=i,this.pieChartData.datasets[0].data=this.indicol.map(f=>f.porcentaje);const a={rojo:">=0",naranja:">25",amarillo:">50",verde:">75"},o=i.map(f=>f.color);this.pieChartData.labels=o.map(f=>a[f]),null!=this.pieChartOptions?.elements?.arc?.backgroundColor&&(this.pieChartOptions.elements.arc.backgroundColor=this.indicol.map(f=>G[f.color])),this.pieChartData={...this.pieChartData};const h=this.indicol.reduce((f,Z)=>f+Z.indica,0),m=this.indicol.reduce((f,Z)=>f+Z.porcentaje,0),C=Math.round(m);this.indicol.push({color:"Total",indica:h,porcentaje:C}),this.indicol.sort((f,Z)=>{const D=["verde","amarillo","naranja","rojo","Total"];return D.indexOf(f.color)-D.indexOf(Z.color)}),this.tabla=new d.by(this.indicol)})}valorespr(){this.criterioService.getvalorad(this.id_modelo,this.user.id).subscribe(i=>{this.valoresp=i,this.barChartData.labels=this.valoresp.map(a=>a.nomcriterio),this.barChartData.datasets[0].data=this.valoresp.map(a=>a.vlObtenido),this.barChartData.datasets[1].data=this.valoresp.map(a=>a.vlobtener),this.barChartData={...this.barChartData}})}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(S.r),t.Y36(x.ye),t.Y36(N.y),t.Y36(q.Q),t.Y36(P.X),t.Y36(J.j),t.Y36(q.Q),t.Y36(k.v),t.Y36(L.g),t.Y36(u.F0))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-detalle-modelo"]],viewQuery:function(i,a){if(1&i&&(t.Gf(x.NW,5),t.Gf(F.jh,5)),2&i){let o;t.iGM(o=t.CRH())&&(a.paginator=o.first),t.iGM(o=t.CRH())&&(a.chart=o.first)}},decls:2,vars:2,consts:[[4,"ngIf"],[1,"text-center","text-dark",2,"margin-top","1%","font-style","italic"],[1,"blockquote","text-dark"],[1,"carousel-container"],["src","./assets/LOGO_CUADRADO_SIN FONDO.png","alt","Imagen 1"],[1,"container","bg-light","border","border-start-0","rounded-4"],[1,"container","contenedor"],[1,"text-center"],["style","border-bottom: thick double #32a1ce;","class","pie-grid","id","indic",4,"ngIf"],[2,"display","flex","border-bottom","thick double #32a1ce"],[2,"flex-basis","70%","border-right","thick double #32a1ce"],["class","imagen",4,"ngIf"],[1,"barra",2,"flex-basis","30%","margin-top","2%"],[2,"width","100%","height","90%","margin-top","1%"],[2,"width","90%","height","90%"],["id","tit2"],[2,"font-weight","bold"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","indicadores"],["mat-header-cell","","style","background-color: gray;",4,"matHeaderCellDef"],["mat-cell","",3,"background-color",4,"matCellDef"],["matColumnDef","nindi"],["mat-header-cell","","style","background-color: gray; text-align: center;",4,"matHeaderCellDef"],["mat-cell","","style"," text-align: center;",4,"matCellDef"],["matColumnDef","porcentaje"],["mat-header-cell","","style","background-color: gray;text-align: center;",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[2,"font-weight","bold","margin-left","5%","margin-top","2%"],["baseChart","",1,"chart",3,"data","options","plugins","type","chartClick"],[1,"barra",2,"flex-basis","30%","margin-top","1%"],[2,"font-weight","bold","margin-left","10%"],["baseChart","",1,"chart",3,"data","type","options","plugins"],["id","indic",1,"pie-grid",2,"border-bottom","thick double #32a1ce"],["class","card","title","Haga clic para ver los datos",3,"background-color","border","click",4,"ngFor","ngForOf"],["title","Haga clic para ver los datos",1,"card",3,"click"],[1,"card-content"],[1,"card-name",2,"color","black"],[1,"card-tot"],[1,"imagen"],["src","./assets/LOGO_CUADRADO_SIN FONDO.png","alt","Logo ista"],["id","tit"],[1,"btn-tabs"],["mat-button","",1,"btn-tab",3,"ngClass","click"],[2,"display","flex","margin-bottom","2%"],[1,"mat-elevation-z8","tabla-container"],["mat-table","",3,"dataSource"],["matColumnDef","Criterio"],["mat-header-cell","",3,"display",4,"matHeaderCellDef"],["mat-cell","","style","padding: 4px;  font-size: 12px; ",3,"display","background-color",4,"matCellDef"],["matColumnDef","Subcriterio"],["mat-cell","","style","padding: 4px; font-size: 12px;",3,"background-color","display",4,"matCellDef"],["matColumnDef","Indicador"],["matColumnDef","Peso"],["mat-cell","","style","padding: 4px; font-size: 12px;","class","centrar",3,"display",4,"matCellDef"],["matColumnDef","Obtenido"],["mat-cell","","style","padding: 4px; font-size: 12px;",3,"display","ngClass",4,"matCellDef"],["matColumnDef","Utilidad"],["matColumnDef","Valor"],["matColumnDef","Evidencia"],["mat-cell","","style","padding: 4px; font-size: 12px;","class","scrollable-cell",3,"background-color","display",4,"matCellDef"],["mat-header-cell",""],["mat-cell","",2,"padding","4px","font-size","12px"],["mat-cell","",1,"centrar",2,"padding","4px","font-size","12px"],["mat-cell","",2,"padding","4px","font-size","12px",3,"ngClass"],["mat-cell","",1,"scrollable-cell",2,"padding","4px","font-size","12px"],["mat-header-row",""],["mat-row",""],["mat-header-cell","",2,"background-color","gray"],["mat-cell",""],["mat-header-cell","",2,"background-color","gray","text-align","center"],["mat-cell","",2,"text-align","center"]],template:function(i,a){1&i&&(t.YNc(0,Zi,11,0,"div",0),t.YNc(1,ee,41,15,"div",0)),2&i&&(t.Q6J("ngIf",!a.consul),t.xp6(1),t.Q6J("ngIf",a.consul))},dependencies:[l.mk,l.sg,l.O5,xi.lW,d.BZ,d.fO,d.as,d.w1,d.Dz,d.nj,d.ge,d.ev,d.XQ,d.Gk,F.jh,l.JJ,l.uU],styles:[".table-container[_ngcontent-%COMP%]{border:1px solid #ccc;padding:10px;overflow-x:auto;max-width:100%}.carousel-container[_ngcontent-%COMP%]{display:flex;overflow:hidden;width:300px;height:200px;margin:0 auto}img[_ngcontent-%COMP%]{width:100%;height:100%}.imagen[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;max-height:100%;width:auto;height:auto;display:block;margin:0 auto;opacity:.5}body[_ngcontent-%COMP%]{font:1em/1.618 Inter,sans-serif;display:flex;align-items:center;justify-content:center;min-height:100vh;padding:30px;color:#224}.pie-grid[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:20px;padding:20px;justify-content:center}.card[_ngcontent-%COMP%]{width:170px;height:170px;background-color:transparent;border-radius:50%;border:8px solid #a7b7e2b9;display:flex;justify-content:center;align-items:center;box-shadow:0 2px 4px #0000001a}.card-content[_ngcontent-%COMP%]{text-align:center;color:#000;font-size:16px;font-weight:700}.card-tot[_ngcontent-%COMP%]{text-align:center;color:#000;font-size:12px}.card-name[_ngcontent-%COMP%]{font-size:14px;font-weight:700;color:#000}.btn-tabs[_ngcontent-%COMP%]{display:flex}.btn-tab[_ngcontent-%COMP%]{padding:10px 20px;border:none;background-color:#dca500;color:#000;font-weight:700;transform-origin:top right;transform:skew(-20deg);margin-right:-10px;cursor:pointer;transition:background-color .3s ease-in-out,color .3s ease-in-out}.btn-tab.selected[_ngcontent-%COMP%]{background-color:#044c9b;color:#fff}.tabla-container[_ngcontent-%COMP%]{max-height:750px;overflow-y:auto}.rojo[_ngcontent-%COMP%]{background-color:red;color:#fff;text-align:center}.centrar[_ngcontent-%COMP%]{background-color:#fcfafa;color:#020202;text-align:center}.naranja[_ngcontent-%COMP%]{background-color:orange;color:#fff;text-align:center}.amarillo[_ngcontent-%COMP%]{background-color:#ff0;text-align:center}.verde[_ngcontent-%COMP%]{background-color:green;color:#fff;text-align:center}.imagen[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:80%;max-height:80%;width:auto;height:auto;display:block;margin:0 auto}.chart[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:10px;box-shadow:0 7px 25px #00000014;width:100%}.chart[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:5px;font-size:20px;color:#666;text-align:center}"],data:{animation:[(0,M.X$)("detailExpand",[(0,M.SB)("collapsed",(0,M.oB)({height:"0px",minHeight:"0"})),(0,M.SB)("expanded",(0,M.oB)({height:"*"})),(0,M.eR)("expanded <=> collapsed",(0,M.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}}),e})();var oe=s(9808),H=s(2271);const re=["datosModalRef"];function ne(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td")(8,"button",6),t.NdJ("click",function(){const h=t.CHM(i).$implicit,m=t.oxw();return t.KtG(m.verDetalles(h))}),t._uU(9," Ver "),t.qZA()()()}if(2&e){const i=r.$implicit;t.xp6(2),t.Oqu(i.id_subcriterio),t.xp6(2),t.Oqu(i.nombre),t.xp6(2),t.Oqu(i.descripcion)}}let se=(()=>{class e{constructor(i,a,o,h,m,C,f,Z,D){this.indicadorservice=i,this.subcriterioservice=a,this.router=o,this.fb=h,this.route=m,this.sharedDataService=C,this.asignacionIndicadorService=f,this.criterioService=Z,this.modeloService=D,this.searchText="",this.criterio=new oe.v,this.model=new R.Z,this.modelo=new R.Z,this.subcriterios=[],this.buscar="",this.subcrite=new H.p,this.frmSubcriterio=h.group({nombre:["",p.kI.required],descripcion:["",[p.kI.required,p.kI.maxLength(250)]]})}ngOnInit(){const i=history.state.data;console.log(i),this.criterio=i;let a=localStorage.getItem("id");this.modeloService.getModeloById(Number(a)).subscribe(o=>{this.modelo=o,this.recibeSubcriterio()})}recibeSubcriterio(){let i=localStorage.getItem("id");this.modeloService.getModeloById(Number(i)).subscribe(a=>{this.model=a,this.sharedDataService.obtenerIdCriterio(),this.asignacionIndicadorService.getAsignacionIndicadorByIdModelo(Number(i)).subscribe(o=>{this.subcriterioservice.getSubcriterios().subscribe(h=>{this.dataSource=[],this.asignacion=o,this.dataSource=h.filter(m=>o.some(C=>m.id_subcriterio===C.indicador.subcriterio.id_subcriterio&&m.criterio?.id_criterio===this.sharedDataService.obtenerIdCriterio())),console.log(this.dataSource)})})})}verDetalles(i){console.log(i),this.sharedDataService.mostaridSubcriterio(i.id_subcriterio),this.router.navigate(["/res/subcriterio-indicador"])}verCriterios(){this.router.navigate(["/sup/flujo-criterio/criterioSuper"])}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(q.Q),t.Y36(J.j),t.Y36(u.F0),t.Y36(p.qu),t.Y36(u.gz),t.Y36(L.g),t.Y36(k.v),t.Y36(P.X),t.Y36(N.y))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-detalle-subcriterio"]],viewQuery:function(i,a){if(1&i&&t.Gf(re,5),2&i){let o;t.iGM(o=t.CRH())&&(a.datosModalRef=o.first)}},decls:20,vars:4,consts:[[1,"container","bg-light","border","border-start-0","rounded-4"],[1,"container"],[2,"text-align","center"],[1,"detalle"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],["type","button",1,"btn","btn-outline-primary",3,"click"]],template:function(i,a){1&i&&(t.TgZ(0,"body")(1,"div",0)(2,"div",1)(3,"h1",2),t._uU(4,"DETALLE DE SUBCRITERIOS"),t.qZA(),t._UZ(5,"div",3),t.TgZ(6,"table",4)(7,"thead")(8,"tr")(9,"th"),t._uU(10,"ID"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"NOMBRE"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"DESCRIPCI\xd3N"),t.qZA(),t.TgZ(15,"th"),t._uU(16," VER DETALLE INDICADORES"),t.qZA()()(),t.TgZ(17,"tbody"),t.YNc(18,ne,10,3,"tr",5),t.ALo(19,"buscar"),t.qZA()()()()()),2&i&&(t.xp6(18),t.Q6J("ngForOf",t.xi3(19,1,a.dataSource,a.searchText)))},dependencies:[l.sg,$.o],styles:["div.detalle[_ngcontent-%COMP%]{border:2px solid #040936;left:10px}p.fant[_ngcontent-%COMP%]{font-family:sans-serif;left:10px;text-align:left}body[_ngcontent-%COMP%]{font:1em/1.618 Inter,sans-serif;display:flex;align-items:center;justify-content:center;min-height:100vh;padding:30px;color:#224}"]}),e})();var ce=s(8896);const de=["datosModalRef"];function le(e,r){if(1&e&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA(),t.TgZ(15,"td"),t._uU(16),t.qZA()()),2&e){const i=r.$implicit;t.xp6(2),t.Oqu(i.id_indicador),t.xp6(2),t.Oqu(i.nombre),t.xp6(2),t.Oqu(i.descripcion),t.xp6(2),t.Oqu(i.peso),t.xp6(2),t.Oqu(i.valor_obtenido),t.xp6(1),t.ekj("color-verde","verde"===i.color)("color-rojo","rojo"===i.color)("color-naranja","naranja"===i.color)("color-amarillo","amarillo"===i.color),t.xp6(1),t.hij(" ",i.porc_obtenido," % "),t.xp6(2),t.Oqu(i.estandar),t.xp6(2),t.Oqu(i.tipo)}}let ue=(()=>{class e{constructor(i,a,o,h,m,C,f){this.indicadorservice=i,this.router=a,this.fb=o,this.route=h,this.modeloService=m,this.asignacionIndicadorService=C,this.sharedDataService=f,this.searchText="",this.subcriterio=new H.p,this.buscar="",this.indic=new ce.s,this.indicadors=[],this.guardadoExitoso=!1,this.model=new R.Z,this.frmIndicador=o.group({nombre:["",p.kI.required],descripcion:["",[p.kI.required,p.kI.maxLength(250)]],peso:["",p.kI.required],estandar:["",p.kI.required],tipo:["",p.kI.required]})}ngOnInit(){const i=history.state.data;console.log(i),this.subcriterio=history.state.data,this.recibeIndicador()}colresIndicador(){this.dataSource.forEach(i=>{i.porc_obtenido=100*i.valor_obtenido/i.peso,i.color=i.porc_obtenido>75&&i.porc_obtenido<=100?"verde":i.porc_obtenido>50&&i.porc_obtenido<=75?"amarillo":i.porc_obtenido>25&&i.porc_obtenido<=50?"naranja":i.porc_obtenido<=25?"rojo":""})}recibeIndicador(){let i=localStorage.getItem("id");this.modeloService.getModeloById(Number(i)).subscribe(a=>{this.model=a,this.asignacionIndicadorService.getAsignacionIndicadorByIdModelo(Number(i)).subscribe(o=>{this.indicadorservice.getIndicadors().subscribe(h=>{this.dataSource=[],this.asignacion=o,this.dataSource=h.filter(m=>o.some(C=>m.id_indicador===C.indicador.id_indicador&&m.subcriterio?.id_subcriterio===this.sharedDataService.obtenerIdSubCriterio())),this.colresIndicador(),console.log(this.dataSource)})})})}verSubcriterios(){this.router.navigate(["/sup/flujo-criterio/criterios-subcriterio"],{state:{data:this.subcriterio.criterio}})}verCriterios(){this.router.navigate(["/sup/flujo-criterio/criterioSuper"])}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(q.Q),t.Y36(u.F0),t.Y36(p.qu),t.Y36(u.gz),t.Y36(N.y),t.Y36(k.v),t.Y36(L.g))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-detalle-indicador"]],viewQuery:function(i,a){if(1&i&&t.Gf(de,5),2&i){let o;t.iGM(o=t.CRH())&&(a.datosModalRef=o.first)}},decls:29,vars:4,consts:[[1,"container","bg-light","border","border-start-0","rounded-4"],[1,"container"],[2,"text-align","center"],[1,"detalle"],[1,"table","table-hover"],[4,"ngFor","ngForOf"]],template:function(i,a){1&i&&(t.TgZ(0,"body")(1,"div",0)(2,"div",1)(3,"h1",2),t._uU(4,"DETALLE DE INDICADORES"),t.qZA(),t.TgZ(5,"div",3),t._UZ(6,"br"),t.TgZ(7,"table",4)(8,"thead")(9,"tr")(10,"th"),t._uU(11,"ID"),t.qZA(),t.TgZ(12,"th"),t._uU(13,"NOMBRE"),t.qZA(),t.TgZ(14,"th"),t._uU(15,"DESCRIPCION"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"PESO"),t.qZA(),t.TgZ(18,"th"),t._uU(19,"VALOR OBTENIDO"),t.qZA(),t.TgZ(20,"th"),t._uU(21,"% VALOR OBTENIDO"),t.qZA(),t.TgZ(22,"th"),t._uU(23,"ESTANDAR"),t.qZA(),t.TgZ(24,"th"),t._uU(25,"TIPO"),t.qZA()()(),t.TgZ(26,"tbody"),t.YNc(27,le,17,16,"tr",5),t.ALo(28,"buscar"),t.qZA()()()()()()),2&i&&(t.xp6(27),t.Q6J("ngForOf",t.xi3(28,1,a.dataSource,a.searchText)))},dependencies:[l.sg,$.o],styles:["div.detalle[_ngcontent-%COMP%]{border:2px solid #040936;left:10px}p.fant[_ngcontent-%COMP%]{font-family:sans-serif;left:10px;text-align:left}body[_ngcontent-%COMP%]{font:1em/1.618 Inter,sans-serif;display:flex;align-items:center;justify-content:center;min-height:100vh;padding:30px;color:#224}"]}),e})(),z=(()=>{class e{constructor(i,a){this.loginService=i,this.router=a}canActivate(i,a){return!(!this.loginService.isLoggedIn()||"RESPONSABLE"!=this.loginService.getUserRole())||(this.router.navigate(["login"]),!1)}}return e.\u0275fac=function(i){return new(i||e)(t.LFG(S.r),t.LFG(u.F0))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var w=s(7940);const he=[{path:"ActividadesResponsable",component:Nt,pathMatch:"full",canActivate:[w.m],data:{allowedRoles:["RESPONSABLE","SUPERADMIN","ADMIN"]}},{path:"evidenciaResponsable",component:Ht,pathMatch:"full",canActivate:[w.m],data:{allowedRoles:["RESPONSABLE","SUPERADMIN","ADMIN"]}},{path:"evidenasignada",component:fi,pathMatch:"full",canActivate:[w.m],data:{allowedRoles:["RESPONSABLE","SUPERADMIN","ADMIN"]}},{path:"actividadCriterio",component:Ai,canActivate:[w.m],data:{allowedRoles:["RESPONSABLE","ADMIN"]}},{path:"detalleC",component:ae,pathMatch:"full",canActivate:[w.m],data:{allowedRoles:["RESPONSABLE","ADMIN"]}},{path:"criterio-subcriterio",component:se,pathMatch:"full",canActivate:[z]},{path:"subcriterio-indicador",component:ue,pathMatch:"full",canActivate:[z]}];let pe=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[u.Bz.forChild(he),u.Bz]}),e})();var _e=s(1327);let me=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[l.ez,pe,_e.m]}),e})()},7940:(E,b,s)=>{s.d(b,{m:()=>A});var l=s(4650),u=s(4120),v=s(1635);let A=(()=>{class g{constructor(n,c,_){this.loginService=n,this.router=c,this.route=_}canActivate(n){const c=n.data.allowedRoles,_=this.loginService.getUserRole();return _&&!!c.includes(_)||(this.router.navigate(["/denegado"]),!1)}}return g.\u0275fac=function(n){return new(n||g)(l.LFG(u.r),l.LFG(v.F0),l.LFG(v.gz))},g.\u0275prov=l.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()},3224:(E,b,s)=>{s.d(b,{_:()=>A});var l=s(5567),u=s(4650),v=s(529);let A=(()=>{class g{constructor(n){this.http=n}search(n){return this.http.get(`${l.Z}/api/actividad/buscar/?nombre=${n}`)}get(){return this.http.get(`${l.Z}/api/actividad/listarv`)}getAc(n){return this.http.get(`${l.Z}/api/actividad/listaractiv/${n}`)}crear(n){return this.http.post(`${l.Z}/api/actividad/crear`,n)}getActividadrechazada(n){return this.http.get(`${l.Z}/api/actividad/actividadatrasa/${n}`)}getActividadaprobada(n){return this.http.get(`${l.Z}/api/actividad/actividadaprobada/${n}`)}getActividadpendiente(n){return this.http.get(`${l.Z}/api/actividad/actividadpendiente/${n}`)}update(n,c){return console.log(c),this.http.put(`${l.Z}/api/actividad/actualizar/${n}`,c)}eliminar(n){return this.http.put(`${l.Z}/api/actividad/eliminarlogic/${n.id_actividad}`,n)}geteviasig(n){return this.http.get(`${l.Z}/api/actividad/buscarusuario/${n}`)}getactivievid(n,c){return this.http.get(`${l.Z}/api/actividad/activevid/${n}/${c}`)}createObservacion(n){return this.http.post(`${l.Z}/api/observacion/crear`,n)}getObservacionByActi(n){return this.http.get(`${l.Z}/api/observacion/buscarObserByActiv/`+n)}eliminarObser(n){return console.log(n),this.http.put(`${l.Z}/api/observacion/eliminarlogic/${n}`,n)}getEviAsig(n){return this.http.get(`${l.Z}/api/actividad/buscarporEvide/${n}`)}getActByUsua(n){return this.http.get(`${l.Z}/api/actividad/buscarByUsuario/${n}`)}getActUsu(n){return this.http.get(`${l.Z}/api/actividad/buscaractiv/${n}`)}getObservaciones(n){return this.http.get(`${l.Z}/api/observacion/obseractividad/${n}`)}}return g.\u0275fac=function(n){return new(n||g)(u.LFG(v.eN))},g.\u0275prov=u.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()},3891:(E,b,s)=>{s.d(b,{g:()=>g});var l=s(529),u=s(2340),v=s(5567),A=s(4650);let g=(()=>{class p{constructor(c){this.http=c,this.baserrl=u.N.baserUrl}cargar(c,_,d){const x=new FormData;x.append("file",c),x.append("descripcion",_),x.append("id_evidencia",d.toString());const Y=new l.aW("POST",`${this.baserrl}/archivo/upload`,x,{reportProgress:!0,responseType:"json"});return this.http.request(Y)}cargarArchivo(c,_){const d=new FormData;return d.append("file",c),d.append("descripcion",_),this.http.post(`${this.baserrl}/archivo/upload`,d)}get(){return this.http.get(`${v.Z}/archivo/listarv`)}getarchivoindi(c,_,d){return this.http.get(`${v.Z}/archivo/archivoindi/${c}/${_}/${d}`)}getDatos(){return this.http.get(`${v.Z}/archivo/listararchi`)}listar(){return this.http.get(`${this.baserrl}/archivo/listar`)}borrar(c){return this.http.get(`${this.baserrl}/archivo/borrar/${c}`)}geteviasig(c){return this.http.get(`${v.Z}/archivo/buscarev/${c}`)}getarchivoActividad(c){return this.http.get(`${v.Z}/archivo/buscararchivo/${c}`)}eliminar(c){return this.http.put(`${v.Z}/archivo/eliminarlogic/${c.id_archivo}`,c)}}return p.\u0275fac=function(c){return new(c||p)(A.LFG(l.eN))},p.\u0275prov=A.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})()},2130:(E,b,s)=>{s.d(b,{Z:()=>g});var l=s(4004),u=s(5567),v=s(4650),A=s(529);let g=(()=>{class p{constructor(c){this.httpClient=c}listarUsuario(){return this.httpClient.get(`${u.Z}/usuarios/listar`).pipe((0,l.U)(c=>c))}listarEvidencia(){return this.httpClient.get(`${u.Z}/api/evidencia/listarv`).pipe((0,l.U)(c=>c))}listarEvidenciaprueba(){return this.httpClient.get(`${u.Z}/api/evidencia/listarpruebasevi`).pipe((0,l.U)(c=>c))}createAsigna(c){return this.httpClient.post(`${u.Z}/api/asignacionevidencia/crear`,c)}listarAsignarEvi(){return this.httpClient.get(`${u.Z}/api/asignacionevidencia/listarv`).pipe((0,l.U)(c=>c))}getfechaAsignacion(c,_){return this.httpClient.get(`${u.Z}/api/asignacionevidencia/fecha/${c}/${_}`)}updateAsigna(c){return console.log(c.id_asignacion_evidencia),this.httpClient.put(`${u.Z}/api/asignacionevidencia/actualizar/`+c.id_asignacion_evidencia,c)}editarAsigna(c){return this.httpClient.put(`${u.Z}/api/asignacionevidencia/editar/`+c.id_asignacion_evidencia,c)}deleteAsigna(c){return this.httpClient.put(`${u.Z}/api/asignacionevidencia/eliminarlogic/`+c.id_asignacion_evidencia,c)}getbuscarAsignacion(c){return this.httpClient.get(`${u.Z}/api/asignacionevidencia/buscar/${c}`)}eliminarAsignaLogic(c){return console.log(c),this.httpClient.put(`${u.Z}/api/asignacionevidencia/eliminarlogic/${c}`,c)}eliminasigna(c,_,d,x){return console.log(c),this.httpClient.put(`${u.Z}/api/asignacionevidencia/elimasig/${c}/${_}/${d}/${x}`,c)}getAsignacionUsuario(c){return this.httpClient.get(`${u.Z}/api/asignacionevidencia/listarEviUsua/`+c)}getAsignacion(){return this.httpClient.get(`${u.Z}/api/asignacionevidencia/listasignacion`)}}return p.\u0275fac=function(c){return new(c||p)(v.LFG(A.eN))},p.\u0275prov=v.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})()},8519:(E,b,s)=>{s.d(b,{u:()=>p});var l=s(262),u=s(2843),v=s(5567),A=s(4650),g=s(529);let p=(()=>{class n{constructor(_){this.http=_}create(_){return this.http.post(`${v.Z}/api/detalle_evaluacion/crear`,_).pipe((0,l.K)(d=>{throw console.error(d),d}))}getDetalleEvi(_){return this.http.get(`${v.Z}/api/detalle_evaluacion/listarporEviRecha/${_}`).pipe((0,l.K)(d=>(console.log("Error:",d),(0,u._)("Hubo un error al obtener los detalles de evaluaci\xf3n"))))}getDetalleEviApro(_,d){return this.http.get(`${v.Z}/api/detalle_evaluacion/listarporEviApro/${_}/${d}`).pipe((0,l.K)(x=>(console.log("Error:",x),(0,u._)("Hubo un error al obtener los detalles de evaluaci\xf3n"))))}eliminar(_){return console.log(_),this.http.put(`${v.Z}/api/detalle_evaluacion/eliminarlogic/${_}`,_)}actualizar(_,d){return this.http.put(`${v.Z}/api/detalle_evaluacion/actualizar/${_}`,d)}getObservaciones(_,d){return this.http.get(`${v.Z}/api/detalle_evaluacion/observaciones/${_}/${d}`)}}return n.\u0275fac=function(_){return new(_||n)(A.LFG(g.eN))},n.\u0275prov=A.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()},2185:(E,b,s)=>{s.d(b,{u:()=>A});var l=s(529),u=s(5567),v=s(4650);let A=(()=>{class g{constructor(n){this.http=n,this.evidenciaObj=[],this.httpHeaders=new l.WM({"Content-Type":"application/json"})}crear(n){return this.http.post(`${u.Z}/api/evidencia/crear`,n)}actualizar(n,c){return this.http.put(`${u.Z}/api/evidencia/actualizar/${n}`,c)}getEvidencias(){return this.http.get(`${u.Z}/api/evidencia/listarv`)}getEvidenciasAdmin(n){return this.http.get(`${u.Z}/api/evidencia/listarvAsigna/${n}`)}getEvidenciaCrite(n){return this.http.get(`${u.Z}/api/evidencia/evicriterio/${n}`)}eliminarEvidencia(n){return this.http.put(`${u.Z}/api/evidencia/eliminarlogic/${n.id_evidencia}`,n)}getEvidenciaIndicador(n){return this.http.get(`${u.Z}/api/evidencia/listarIndicador/${n}`)}getAsignacionUsuario(n){return this.http.get(`${u.Z}/api/asignacionevidencia/listarEviUsua/`+n)}geteviasig(n){return this.http.get(`${u.Z}/api/evidencia/buscarev/${n}`)}getevilist(n){return this.http.get(`${u.Z}/api/evidencia/evidenuser/${n}`)}getevical(n,c){return this.http.get(`${u.Z}/api/evidencia/evidenciacal/${n}/${c}`)}getevitab(n){return this.http.get(`${u.Z}/api/evidencia/eviasigtab/${n}`)}geteviadmin(n){return this.http.get(`${u.Z}/api/evidencia/eviasigadmin/${n}`)}listarUsuario(){return this.http.get(`${u.Z}/usuarios/listarResDatos`)}geteviaprobada(n){return this.http.get(`${u.Z}/api/evidencia/evidenciaprobada/${n}`)}getevirechazada(n){return this.http.get(`${u.Z}/api/evidencia/evidenciarechazada/${n}`)}getEvidenciaPorIndicador(n){return this.http.get(`${u.Z}/api/evidencia/listarEvidenciaPorIndicador/${n}`)}buscar(n){return this.http.get(`${u.Z}/api/evidencia/buscar/${n}`)}listarUsuarioRes(){return this.http.get(`${u.Z}/usuarios/listarResponsableAdmin`)}listarsolorespon(){return this.http.get(`${u.Z}/usuarios/listarsoloResponsables`)}}return g.\u0275fac=function(n){return new(n||g)(v.LFG(l.eN))},g.\u0275prov=v.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()},404:(E,b,s)=>{s.d(b,{j:()=>p});var l=s(262),u=s(4004),v=s(5567),A=s(4650),g=s(529);let p=(()=>{class n{constructor(_){this.http=_}getSubcriterios(){return this.http.get(`${v.Z}/api/subcriterio/listar`)}getSubcritIndi(_,d){return this.http.get(`${v.Z}/api/subcriterio/subcritindi/${_}/${d}`)}crear(_){return this.http.post(`${v.Z}/api/subcriterio/crear`,_).pipe((0,l.K)(d=>{throw console.error(d),d}))}listarSubcriterio(){return this.http.get(`${v.Z}/api/subcriterio/listar`).pipe((0,u.U)(_=>_))}actualizar(_,d){return this.http.put(`${v.Z}/api/subcriterio/actualizar/${_}`,d)}eliminar(_){return this.http.put(`${v.Z}/api/subcriterio/eliminar/${_.id_subcriterio}`,_)}listarSubcriterioPorCriterio(_){return this.http.get(`${v.Z}/api/subcriterio/listarPorCriterio/${_}`).pipe((0,u.U)(d=>d))}geSubcritebyId(_){return this.http.get(`${v.Z}/api/subcriterio/buscar/${_}`).pipe((0,u.U)(d=>d))}obtenerDatosCriterios(_){return this.http.get(`${v.Z}/api/subcriterio/datosSubcriterios/${_}`)}obtenerDatosSubcriteriosFull(){return this.http.get(`${v.Z}/api/subcriterio/datosSubcriteriosFull`)}}return n.\u0275fac=function(_){return new(_||n)(A.LFG(g.eN))},n.\u0275prov=A.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()},9518:(E,b,s)=>{s.d(b,{o:()=>u});var l=s(4650);let u=(()=>{class v{transform(g,p){return g?p?(p=p.toLowerCase(),g.filter(n=>JSON.stringify(n).toLowerCase().includes(p))):g:null}}return v.\u0275fac=function(g){return new(g||v)},v.\u0275pipe=l.Yjl({name:"buscar",type:v,pure:!0}),v})()}}]);